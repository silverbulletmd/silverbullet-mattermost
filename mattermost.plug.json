{
  "name": "mattermost",
  "imports": [
    "https://get.silverbullet.md/global.plug.json"
  ],
  "dependencies": {
    "https://esm.sh/@mattermost/client@7.4.0": "(() => { var mod=(()=>{var N=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var S=(h=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(h,{get:(r,u)=>(typeof require!=\"undefined\"?require:r)[u]}):h)(function(h){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+h+'\" is not supported')});var U=(h,r)=>()=>(h&&(r=h(h=0)),r);var oe=(h,r)=>()=>(r||h((r={exports:{}}).exports,r),r.exports),he=(h,r)=>{for(var u in r)N(h,u,{get:r[u],enumerable:!0})},re=(h,r,u,m)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of se(r))!ie.call(h,n)&&n!==u&&N(h,n,{get:()=>r[n],enumerable:!(m=te(r,n))||m.enumerable});return h};var ae=h=>re(N({},\"__esModule\",{value:!0}),h);var ne,I,de,ue,ce,ge,le,pe,me,_e,M,ze,J,$e,L,w=U(()=>{ne=Object.create,I=Object.defineProperty,de=Object.getOwnPropertyDescriptor,ue=Object.getOwnPropertyNames,ce=Object.getPrototypeOf,ge=Object.prototype.hasOwnProperty,le=(h,r)=>()=>(r||h((r={exports:{}}).exports,r),r.exports),pe=(h,r,u,m)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of ue(r))!ge.call(h,n)&&n!==u&&I(h,n,{get:()=>r[n],enumerable:!(m=de(r,n))||m.enumerable});return h},me=(h,r,u)=>(u=h!=null?ne(ce(h)):{},pe(r||!h||!h.__esModule?I(u,\"default\",{value:h,enumerable:!0}):u,h)),_e=le(h=>{\"use strict\";Object.defineProperty(h,\"__esModule\",{value:!0}),h.LogLevel=void 0;var r;(function(u){u.Error=\"ERROR\",u.Warning=\"WARNING\",u.Info=\"INFO\",u.Debug=\"DEBUG\"})(r=h.LogLevel||(h.LogLevel={}))}),M=me(_e()),{LogLevel:ze}=M,{default:J,...$e}=M,L=J!==void 0?J:$e});var Re,Q,ye,be,Fe,fe,ve,Se,Ce,Oe,D,Ke,Ye,j,ke,x,G=U(()=>{Re=Object.create,Q=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,be=Object.getOwnPropertyNames,Fe=Object.getPrototypeOf,fe=Object.prototype.hasOwnProperty,ve=(h,r)=>()=>(r||h((r={exports:{}}).exports,r),r.exports),Se=(h,r,u,m)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of be(r))!fe.call(h,n)&&n!==u&&Q(h,n,{get:()=>r[n],enumerable:!(m=ye(r,n))||m.enumerable});return h},Ce=(h,r,u)=>(u=h!=null?Re(Fe(h)):{},Se(r||!h||!h.__esModule?Q(u,\"default\",{value:h,enumerable:!0}):u,h)),Oe=ve((h,r)=>{r.exports=typeof self==\"object\"?self.FormData:window.FormData}),D=Ce(Oe()),{LINE_BREAK:Ke,DEFAULT_CONTENT_TYPE:Ye}=D,{default:j,...ke}=D,x=j!==void 0?j:ke});var Te,q,Ee,Ue,Pe,Ne,st,T,Be,Ae,Je,Ie,Me,Le,we,H,je,Qe,De,xe,Ge,We,W,qe,V,B=U(()=>{w();G();Te=Object.create,q=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,Ue=Object.getOwnPropertyNames,Pe=Object.getPrototypeOf,Ne=Object.prototype.hasOwnProperty,st=(h=>typeof S<\"u\"?S:typeof Proxy<\"u\"?new Proxy(h,{get:(r,u)=>(typeof S<\"u\"?S:r)[u]}):h)(function(h){if(typeof S<\"u\")return S.apply(this,arguments);throw new Error('Dynamic require of \"'+h+'\" is not supported')}),T=(h,r)=>()=>(r||h((r={exports:{}}).exports,r),r.exports),Be=(h,r,u,m)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of Ue(r))!Ne.call(h,n)&&n!==u&&q(h,n,{get:()=>r[n],enumerable:!(m=Ee(r,n))||m.enumerable});return h},Ae=(h,r,u)=>(u=h!=null?Te(Pe(h)):{},Be(r||!h||!h.__esModule?q(u,\"default\",{value:h,enumerable:!0}):u,h)),Je=T(h=>{\"use strict\";Object.defineProperty(h,\"__esModule\",{value:!0}),h.cleanUrlForLogging=void 0;function r(u,m){let n=m;n=n.substring(u.length);let b=n.indexOf(\"?\");b!==-1&&(n=n.substring(0,b));let C=[\"api\",\"v4\",\"users\",\"teams\",\"scheme\",\"name\",\"members\",\"channels\",\"posts\",\"reactions\",\"commands\",\"files\",\"preferences\",\"hooks\",\"incoming\",\"outgoing\",\"oauth\",\"apps\",\"emoji\",\"brand\",\"image\",\"data_retention\",\"jobs\",\"plugins\",\"roles\",\"system\",\"timezones\",\"schemes\",\"redirect_location\",\"patch\",\"mfa\",\"password\",\"reset\",\"send\",\"active\",\"verify\",\"terms_of_service\",\"login\",\"logout\",\"ids\",\"usernames\",\"me\",\"username\",\"email\",\"default\",\"sessions\",\"revoke\",\"all\",\"audits\",\"device\",\"status\",\"search\",\"switch\",\"authorized\",\"authorize\",\"deauthorize\",\"tokens\",\"disable\",\"enable\",\"exists\",\"unread\",\"invite\",\"batch\",\"stats\",\"import\",\"schemeRoles\",\"direct\",\"group\",\"convert\",\"view\",\"search_autocomplete\",\"thread\",\"info\",\"flagged\",\"pinned\",\"pin\",\"unpin\",\"opengraph\",\"actions\",\"thumbnail\",\"preview\",\"link\",\"delete\",\"logs\",\"ping\",\"config\",\"client\",\"license\",\"websocket\",\"webrtc\",\"token\",\"regen_token\",\"autocomplete\",\"execute\",\"regen_secret\",\"policy\",\"type\",\"cancel\",\"reload\",\"environment\",\"s3_test\",\"file\",\"caches\",\"invalidate\",\"database\",\"recycle\",\"compliance\",\"reports\",\"cluster\",\"ldap\",\"test\",\"sync\",\"saml\",\"certificate\",\"public\",\"private\",\"idp\",\"elasticsearch\",\"purge_indexes\",\"analytics\",\"old\",\"webapp\",\"fake\"];return n=n.split(\"/\").map(o=>o!==\"\"&&C.indexOf(o)===-1?\"<filtered>\":o).join(\"/\"),b!==-1&&(n+=\"?<filtered>\"),n}h.cleanUrlForLogging=r}),Ie=T(h=>{\"use strict\";Object.defineProperty(h,\"__esModule\",{value:!0}),h.buildQueryString=void 0;function r(u){if(Object.keys(u).length===0)return\"\";let m=Object.entries(u).filter(([n,b])=>b!==void 0).map(([n,b])=>`${n}=${encodeURIComponent(b)}`).join(\"&\");return m.length>0?`?${m}`:\"\"}h.buildQueryString=r}),Me=T(h=>{\"use strict\";var r=h&&h.__awaiter||function(e,t,s,i){function a(c){return c instanceof s?c:new s(function(g){g(c)})}return new(s||(s=Promise))(function(c,g){function y(F){try{v(i.next(F))}catch(P){g(P)}}function f(F){try{v(i.throw(F))}catch(P){g(P)}}function v(F){F.done?c(F.value):a(F.value).then(y,f)}v((i=i.apply(e,t||[])).next())})},u=h&&h.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols==\"function\")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(s[i[a]]=e[i[a]]);return s},m=h&&h.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(h,\"__esModule\",{value:!0}),h.ClientError=h.parseAndMergeNestedHeaders=h.suitePluginIds=h.DEFAULT_LIMIT_AFTER=h.DEFAULT_LIMIT_BEFORE=h.HEADER_X_VERSION_ID=h.HEADER_X_CLUSTER_ID=void 0;var n=m(x),b=L,C=Je(),o=Ie(),$=\"Authorization\",p=\"BEARER\",l=\"Content-Type\",R=\"X-Requested-With\",O=\"User-Agent\";h.HEADER_X_CLUSTER_ID=\"X-Cluster-Id\";var _=\"X-CSRF-Token\";h.HEADER_X_VERSION_ID=\"X-Version-Id\";var k=25,d=60,Y=1e4;h.DEFAULT_LIMIT_BEFORE=30,h.DEFAULT_LIMIT_AFTER=30;var Z=\"/api/v5/graphql\";h.suitePluginIds={playbooks:\"playbooks\",focalboard:\"focalboard\",apps:\"com.mattermost.apps\",calls:\"com.mattermost.calls\",nps:\"com.mattermost.nps\",channelExport:\"com.mattermost.plugin-channel-export\"};var ee=class{constructor(){this.logToConsole=!1,this.serverVersion=\"\",this.clusterId=\"\",this.token=\"\",this.csrf=\"\",this.url=\"\",this.urlVersion=\"/api/v4\",this.userAgent=null,this.enableLogging=!1,this.defaultHeaders={},this.userId=\"\",this.diagnosticId=\"\",this.includeCookies=!0,this.setAuthHeader=!0,this.translations={connectionError:\"There appears to be a problem with your internet connection.\",unknownError:\"We received an unexpected status code from the server.\"},this.userRoles=\"\",this.createUser=(e,t,s,i)=>{this.trackEvent(\"api\",\"api_users_create\");let a={};return t&&(a.t=t),s&&(a.iid=s),i&&(a.r=i),this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(a)}`,{method:\"post\",body:JSON.stringify(e)})},this.patchMe=e=>this.doFetch(`${this.getUserRoute(\"me\")}/patch`,{method:\"put\",body:JSON.stringify(e)}),this.patchUser=e=>(this.trackEvent(\"api\",\"api_users_patch\"),this.doFetch(`${this.getUserRoute(e.id)}/patch`,{method:\"put\",body:JSON.stringify(e)})),this.updateUser=e=>(this.trackEvent(\"api\",\"api_users_update\"),this.doFetch(`${this.getUserRoute(e.id)}`,{method:\"put\",body:JSON.stringify(e)})),this.promoteGuestToUser=e=>(this.trackEvent(\"api\",\"api_users_promote_guest_to_user\"),this.doFetch(`${this.getUserRoute(e)}/promote`,{method:\"post\"})),this.demoteUserToGuest=e=>(this.trackEvent(\"api\",\"api_users_demote_user_to_guest\"),this.doFetch(`${this.getUserRoute(e)}/demote`,{method:\"post\"})),this.updateUserRoles=(e,t)=>(this.trackEvent(\"api\",\"api_users_update_roles\"),this.doFetch(`${this.getUserRoute(e)}/roles`,{method:\"put\",body:JSON.stringify({roles:t})})),this.updateUserMfa=(e,t,s)=>{let i={activate:t};return t&&(i.code=s),this.doFetch(`${this.getUserRoute(e)}/mfa`,{method:\"put\",body:JSON.stringify(i)})},this.updateUserPassword=(e,t,s)=>(this.trackEvent(\"api\",\"api_users_newpassword\"),this.doFetch(`${this.getUserRoute(e)}/password`,{method:\"put\",body:JSON.stringify({current_password:t,new_password:s})})),this.resetUserPassword=(e,t)=>(this.trackEvent(\"api\",\"api_users_reset_password\"),this.doFetch(`${this.getUsersRoute()}/password/reset`,{method:\"post\",body:JSON.stringify({token:e,new_password:t})})),this.getKnownUsers=()=>this.doFetch(`${this.getUsersRoute()}/known`,{method:\"get\"}),this.sendPasswordResetEmail=e=>(this.trackEvent(\"api\",\"api_users_send_password_reset\"),this.doFetch(`${this.getUsersRoute()}/password/reset/send`,{method:\"post\",body:JSON.stringify({email:e})})),this.updateUserActive=(e,t)=>(this.trackEvent(\"api\",\"api_users_update_active\"),this.doFetch(`${this.getUserRoute(e)}/active`,{method:\"put\",body:JSON.stringify({active:t})})),this.uploadProfileImage=(e,t)=>{this.trackEvent(\"api\",\"api_users_update_profile_picture\");let s=new n.default;s.append(\"image\",t);let i={method:\"post\",body:s};return s.getBoundary&&(i.headers={\"Content-Type\":`multipart/form-data; boundary=${s.getBoundary()}`}),this.doFetch(`${this.getUserRoute(e)}/image`,i)},this.setDefaultProfileImage=e=>(this.trackEvent(\"api\",\"api_users_set_default_profile_picture\"),this.doFetch(`${this.getUserRoute(e)}/image`,{method:\"delete\"})),this.verifyUserEmail=e=>this.doFetch(`${this.getUsersRoute()}/email/verify`,{method:\"post\",body:JSON.stringify({token:e})}),this.updateMyTermsOfServiceStatus=(e,t)=>this.doFetch(`${this.getUserRoute(\"me\")}/terms_of_service`,{method:\"post\",body:JSON.stringify({termsOfServiceId:e,accepted:t})}),this.getTermsOfService=()=>this.doFetch(`${this.getBaseRoute()}/terms_of_service`,{method:\"get\"}),this.createTermsOfService=e=>this.doFetch(`${this.getBaseRoute()}/terms_of_service`,{method:\"post\",body:JSON.stringify({text:e})}),this.sendVerificationEmail=e=>this.doFetch(`${this.getUsersRoute()}/email/verify/send`,{method:\"post\",body:JSON.stringify({email:e})}),this.login=(e,t,s=\"\",i=!1)=>r(this,void 0,void 0,function*(){this.trackEvent(\"api\",\"api_users_login\"),i&&this.trackEvent(\"api\",\"api_users_login_ldap\");let a={login_id:e,password:t,token:s,deviceId:\"\"};i&&(a.ldap_only=\"true\");let{data:c,headers:g}=yield this.doFetchWithResponse(`${this.getUsersRoute()}/login`,{method:\"post\",body:JSON.stringify(a)});return g.has(\"Token\")&&this.setToken(g.get(\"Token\")),c}),this.loginById=(e,t,s=\"\")=>{this.trackEvent(\"api\",\"api_users_login\");let i={id:e,password:t,token:s,device_id:\"\"};return this.doFetch(`${this.getUsersRoute()}/login`,{method:\"post\",body:JSON.stringify(i)})},this.logout=()=>r(this,void 0,void 0,function*(){this.trackEvent(\"api\",\"api_users_logout\");let{response:e}=yield this.doFetchWithResponse(`${this.getUsersRoute()}/logout`,{method:\"post\"});return e.ok&&(this.token=\"\"),this.serverVersion=\"\",e}),this.getProfiles=(e=0,t=d,s={})=>this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(Object.assign({page:e,per_page:t},s))}`,{method:\"get\"}),this.getProfilesByIds=(e,t={})=>this.doFetch(`${this.getUsersRoute()}/ids${o.buildQueryString(t)}`,{method:\"post\",body:JSON.stringify(e)}),this.getProfilesByUsernames=e=>this.doFetch(`${this.getUsersRoute()}/usernames`,{method:\"post\",body:JSON.stringify(e)}),this.getProfilesInTeam=(e,t=0,s=d,i=\"\",a={})=>this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(Object.assign(Object.assign({},a),{in_team:e,page:t,per_page:s,sort:i}))}`,{method:\"get\"}),this.getProfilesNotInTeam=(e,t,s=0,i=d)=>{let a={not_in_team:e,page:s,per_page:i};return t&&(a.group_constrained=!0),this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(a)}`,{method:\"get\"})},this.getProfilesWithoutTeam=(e=0,t=d,s={})=>this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(Object.assign(Object.assign({},s),{without_team:1,page:e,per_page:t}))}`,{method:\"get\"}),this.getProfilesInChannel=(e,t=0,s=d,i=\"\",a={})=>{let c={in_channel:e,page:t,per_page:s,sort:i};return this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(Object.assign(Object.assign({},c),a))}`,{method:\"get\"})},this.getProfilesInGroupChannels=e=>this.doFetch(`${this.getUsersRoute()}/group_channels`,{method:\"post\",body:JSON.stringify(e)}),this.getProfilesNotInChannel=(e,t,s,i=0,a=d)=>{let c={in_team:e,not_in_channel:t,page:i,per_page:a};return s&&(c.group_constrained=!0),this.doFetch(`${this.getUsersRoute()}${o.buildQueryString(c)}`,{method:\"get\"})},this.getProfilesInGroup=(e,t=0,s=d)=>this.doFetch(`${this.getUsersRoute()}${o.buildQueryString({in_group:e,page:t,per_page:s})}`,{method:\"get\"}),this.getProfilesNotInGroup=(e,t=0,s=d)=>this.doFetch(`${this.getUsersRoute()}${o.buildQueryString({not_in_group:e,page:t,per_page:s})}`,{method:\"get\"}),this.getMe=()=>this.doFetch(`${this.getUserRoute(\"me\")}`,{method:\"get\"}),this.getUser=e=>this.doFetch(`${this.getUserRoute(e)}`,{method:\"get\"}),this.getUserByUsername=e=>this.doFetch(`${this.getUsersRoute()}/username/${e}`,{method:\"get\"}),this.getUserByEmail=e=>this.doFetch(`${this.getUsersRoute()}/email/${e}`,{method:\"get\"}),this.getProfilePictureUrl=(e,t)=>{let s={};return t&&(s._=t),`${this.getUserRoute(e)}/image${o.buildQueryString(s)}`},this.getDefaultProfilePictureUrl=e=>`${this.getUserRoute(e)}/image/default`,this.autocompleteUsers=(e,t,s,i={limit:k})=>this.doFetch(`${this.getUsersRoute()}/autocomplete${o.buildQueryString({in_team:t,in_channel:s,name:e,limit:i.limit})}`,{method:\"get\"}),this.getSessions=e=>this.doFetch(`${this.getUserRoute(e)}/sessions`,{method:\"get\"}),this.revokeSession=(e,t)=>this.doFetch(`${this.getUserRoute(e)}/sessions/revoke`,{method:\"post\",body:JSON.stringify({session_id:t})}),this.revokeAllSessionsForUser=e=>this.doFetch(`${this.getUserRoute(e)}/sessions/revoke/all`,{method:\"post\"}),this.revokeSessionsForAllUsers=()=>this.doFetch(`${this.getUsersRoute()}/sessions/revoke/all`,{method:\"post\"}),this.getUserAudits=(e,t=0,s=d)=>this.doFetch(`${this.getUserRoute(e)}/audits${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.checkUserMfa=e=>this.doFetch(`${this.getUsersRoute()}/mfa`,{method:\"post\",body:JSON.stringify({login_id:e})}),this.generateMfaSecret=e=>this.doFetch(`${this.getUserRoute(e)}/mfa/generate`,{method:\"post\"}),this.searchUsers=(e,t)=>(this.trackEvent(\"api\",\"api_search_users\"),this.doFetch(`${this.getUsersRoute()}/search`,{method:\"post\",body:JSON.stringify(Object.assign({term:e},t))})),this.getStatusesByIds=e=>this.doFetch(`${this.getUsersRoute()}/status/ids`,{method:\"post\",body:JSON.stringify(e)}),this.getStatus=e=>this.doFetch(`${this.getUserRoute(e)}/status`,{method:\"get\"}),this.updateStatus=e=>this.doFetch(`${this.getUserRoute(e.user_id)}/status`,{method:\"put\",body:JSON.stringify(e)}),this.updateCustomStatus=e=>this.doFetch(`${this.getUserRoute(\"me\")}/status/custom`,{method:\"put\",body:JSON.stringify(e)}),this.unsetCustomStatus=()=>this.doFetch(`${this.getUserRoute(\"me\")}/status/custom`,{method:\"delete\"}),this.removeRecentCustomStatus=e=>this.doFetch(`${this.getUserRoute(\"me\")}/status/custom/recent/delete`,{method:\"post\",body:JSON.stringify(e)}),this.switchEmailToOAuth=(e,t,s,i=\"\")=>(this.trackEvent(\"api\",\"api_users_email_to_oauth\"),this.doFetch(`${this.getUsersRoute()}/login/switch`,{method:\"post\",body:JSON.stringify({current_service:\"email\",new_service:e,email:t,password:s,mfa_code:i})})),this.switchOAuthToEmail=(e,t,s)=>(this.trackEvent(\"api\",\"api_users_oauth_to_email\"),this.doFetch(`${this.getUsersRoute()}/login/switch`,{method:\"post\",body:JSON.stringify({current_service:e,new_service:\"email\",email:t,new_password:s})})),this.switchEmailToLdap=(e,t,s,i,a=\"\")=>(this.trackEvent(\"api\",\"api_users_email_to_ldap\"),this.doFetch(`${this.getUsersRoute()}/login/switch`,{method:\"post\",body:JSON.stringify({current_service:\"email\",new_service:\"ldap\",email:e,password:t,ldap_id:s,new_password:i,mfa_code:a})})),this.switchLdapToEmail=(e,t,s,i=\"\")=>(this.trackEvent(\"api\",\"api_users_ldap_to_email\"),this.doFetch(`${this.getUsersRoute()}/login/switch`,{method:\"post\",body:JSON.stringify({current_service:\"ldap\",new_service:\"email\",email:t,password:e,new_password:s,mfa_code:i})})),this.getAuthorizedOAuthApps=e=>this.doFetch(`${this.getUserRoute(e)}/oauth/apps/authorized`,{method:\"get\"}),this.authorizeOAuthApp=(e,t,s,i,a)=>this.doFetch(`${this.url}/oauth/authorize`,{method:\"post\",body:JSON.stringify({client_id:t,response_type:e,redirect_uri:s,state:i,scope:a})}),this.deauthorizeOAuthApp=e=>this.doFetch(`${this.url}/oauth/deauthorize`,{method:\"post\",body:JSON.stringify({client_id:e})}),this.createUserAccessToken=(e,t)=>(this.trackEvent(\"api\",\"api_users_create_access_token\"),this.doFetch(`${this.getUserRoute(e)}/tokens`,{method:\"post\",body:JSON.stringify({description:t})})),this.getUserAccessToken=e=>this.doFetch(`${this.getUsersRoute()}/tokens/${e}`,{method:\"get\"}),this.getUserAccessTokensForUser=(e,t=0,s=d)=>this.doFetch(`${this.getUserRoute(e)}/tokens${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getUserAccessTokens=(e=0,t=d)=>this.doFetch(`${this.getUsersRoute()}/tokens${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.revokeUserAccessToken=e=>(this.trackEvent(\"api\",\"api_users_revoke_access_token\"),this.doFetch(`${this.getUsersRoute()}/tokens/revoke`,{method:\"post\",body:JSON.stringify({token_id:e})})),this.disableUserAccessToken=e=>this.doFetch(`${this.getUsersRoute()}/tokens/disable`,{method:\"post\",body:JSON.stringify({token_id:e})}),this.enableUserAccessToken=e=>this.doFetch(`${this.getUsersRoute()}/tokens/enable`,{method:\"post\",body:JSON.stringify({token_id:e})}),this.createTeam=e=>(this.trackEvent(\"api\",\"api_teams_create\"),this.doFetch(`${this.getTeamsRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.deleteTeam=e=>(this.trackEvent(\"api\",\"api_teams_delete\"),this.doFetch(`${this.getTeamRoute(e)}`,{method:\"delete\"})),this.unarchiveTeam=e=>this.doFetch(`${this.getTeamRoute(e)}/restore`,{method:\"post\"}),this.archiveAllTeamsExcept=e=>this.doFetch(`${this.getTeamRoute(e)}/except`,{method:\"delete\"}),this.updateTeam=e=>(this.trackEvent(\"api\",\"api_teams_update_name\",{team_id:e.id}),this.doFetch(`${this.getTeamRoute(e.id)}`,{method:\"put\",body:JSON.stringify(e)})),this.patchTeam=e=>(this.trackEvent(\"api\",\"api_teams_patch_name\",{team_id:e.id}),this.doFetch(`${this.getTeamRoute(e.id)}/patch`,{method:\"put\",body:JSON.stringify(e)})),this.regenerateTeamInviteId=e=>(this.trackEvent(\"api\",\"api_teams_regenerate_invite_id\",{team_id:e}),this.doFetch(`${this.getTeamRoute(e)}/regenerate_invite_id`,{method:\"post\"})),this.updateTeamScheme=(e,t)=>{let s={scheme_id:t};return this.trackEvent(\"api\",\"api_teams_update_scheme\",Object.assign({team_id:e},s)),this.doFetch(`${this.getTeamSchemeRoute(e)}`,{method:\"put\",body:JSON.stringify(s)})},this.checkIfTeamExists=e=>this.doFetch(`${this.getTeamNameRoute(e)}/exists`,{method:\"get\"}),this.getTeams=(e=0,t=d,s=!1,i=!1)=>this.doFetch(`${this.getTeamsRoute()}${o.buildQueryString({page:e,per_page:t,include_total_count:s,exclude_policy_constrained:i})}`,{method:\"get\"}),this.searchTeams=(e,t)=>(this.trackEvent(\"api\",\"api_search_teams\"),this.doFetch(`${this.getTeamsRoute()}/search`,{method:\"post\",body:JSON.stringify(Object.assign({term:e},t))})),this.getTeam=e=>this.doFetch(this.getTeamRoute(e),{method:\"get\"}),this.getTeamByName=e=>(this.trackEvent(\"api\",\"api_teams_get_team_by_name\"),this.doFetch(this.getTeamNameRoute(e),{method:\"get\"})),this.getMyTeams=()=>this.doFetch(`${this.getUserRoute(\"me\")}/teams`,{method:\"get\"}),this.getTeamsForUser=e=>this.doFetch(`${this.getUserRoute(e)}/teams`,{method:\"get\"}),this.getMyTeamMembers=()=>this.doFetch(`${this.getUserRoute(\"me\")}/teams/members`,{method:\"get\"}),this.getMyTeamUnreads=(e=!1)=>this.doFetch(`${this.getUserRoute(\"me\")}/teams/unread${o.buildQueryString({include_collapsed_threads:e})}`,{method:\"get\"}),this.getTeamMembers=(e,t=0,s=d,i)=>this.doFetch(`${this.getTeamMembersRoute(e)}${o.buildQueryString(Object.assign({page:t,per_page:s},i))}`,{method:\"get\"}),this.getTeamMembersForUser=e=>this.doFetch(`${this.getUserRoute(e)}/teams/members`,{method:\"get\"}),this.getTeamMember=(e,t)=>this.doFetch(`${this.getTeamMemberRoute(e,t)}`,{method:\"get\"}),this.getTeamMembersByIds=(e,t)=>this.doFetch(`${this.getTeamMembersRoute(e)}/ids`,{method:\"post\",body:JSON.stringify(t)}),this.addToTeam=(e,t)=>{this.trackEvent(\"api\",\"api_teams_invite_members\",{team_id:e});let s={user_id:t,team_id:e};return this.doFetch(`${this.getTeamMembersRoute(e)}`,{method:\"post\",body:JSON.stringify(s)})},this.addToTeamFromInvite=(e=\"\",t=\"\")=>{this.trackEvent(\"api\",\"api_teams_invite_members\");let s=o.buildQueryString({token:e,invite_id:t});return this.doFetch(`${this.getTeamsRoute()}/members/invite${s}`,{method:\"post\"})},this.addUsersToTeam=(e,t)=>{this.trackEvent(\"api\",\"api_teams_batch_add_members\",{team_id:e,count:t.length});let s=[];return t.forEach(i=>s.push({team_id:e,user_id:i})),this.doFetch(`${this.getTeamMembersRoute(e)}/batch`,{method:\"post\",body:JSON.stringify(s)})},this.addUsersToTeamGracefully=(e,t)=>{this.trackEvent(\"api\",\"api_teams_batch_add_members\",{team_id:e,count:t.length});let s=[];return t.forEach(i=>s.push({team_id:e,user_id:i})),this.doFetch(`${this.getTeamMembersRoute(e)}/batch?graceful=true`,{method:\"post\",body:JSON.stringify(s)})},this.joinTeam=e=>{let t=o.buildQueryString({invite_id:e});return this.doFetch(`${this.getTeamsRoute()}/members/invite${t}`,{method:\"post\"})},this.removeFromTeam=(e,t)=>(this.trackEvent(\"api\",\"api_teams_remove_members\",{team_id:e}),this.doFetch(`${this.getTeamMemberRoute(e,t)}`,{method:\"delete\"})),this.getTeamStats=e=>this.doFetch(`${this.getTeamRoute(e)}/stats`,{method:\"get\"}),this.getTotalUsersStats=()=>this.doFetch(`${this.getUsersRoute()}/stats`,{method:\"get\"}),this.getFilteredUsersStats=e=>this.doFetch(`${this.getUsersRoute()}/stats/filtered${o.buildQueryString(e)}`,{method:\"get\"}),this.invalidateAllEmailInvites=()=>this.doFetch(`${this.getTeamsRoute()}/invites/email`,{method:\"delete\"}),this.getTeamInviteInfo=e=>this.doFetch(`${this.getTeamsRoute()}/invite/${e}`,{method:\"get\"}),this.updateTeamMemberRoles=(e,t,s)=>(this.trackEvent(\"api\",\"api_teams_update_member_roles\",{team_id:e}),this.doFetch(`${this.getTeamMemberRoute(e,t)}/roles`,{method:\"put\",body:JSON.stringify({roles:s})})),this.sendEmailInvitesToTeam=(e,t)=>(this.trackEvent(\"api\",\"api_teams_invite_members\",{team_id:e}),this.doFetch(`${this.getTeamRoute(e)}/invite/email`,{method:\"post\",body:JSON.stringify(t)})),this.sendEmailGuestInvitesToChannels=(e,t,s,i)=>(this.trackEvent(\"api\",\"api_teams_invite_guests\",{team_id:e,channel_ids:t}),this.doFetch(`${this.getTeamRoute(e)}/invite-guests/email`,{method:\"post\",body:JSON.stringify({emails:s,channels:t,message:i})})),this.sendEmailInvitesToTeamGracefully=(e,t)=>(this.trackEvent(\"api\",\"api_teams_invite_members\",{team_id:e}),this.doFetch(`${this.getTeamRoute(e)}/invite/email?graceful=true`,{method:\"post\",body:JSON.stringify(t)})),this.sendEmailInvitesToTeamAndChannelsGracefully=(e,t,s,i)=>(this.trackEvent(\"api\",\"api_teams_invite_members_to_channels\",{team_id:e,channel_len:t.length}),this.doFetch(`${this.getTeamRoute(e)}/invite/email?graceful=true`,{method:\"post\",body:JSON.stringify({emails:s,channelIds:t,message:i})})),this.sendEmailGuestInvitesToChannelsGracefully=(e,t,s,i)=>r(this,void 0,void 0,function*(){return this.trackEvent(\"api\",\"api_teams_invite_guests\",{team_id:e,channel_ids:t}),this.doFetch(`${this.getTeamRoute(e)}/invite-guests/email?graceful=true`,{method:\"post\",body:JSON.stringify({emails:s,channels:t,message:i})})}),this.getTeamIconUrl=(e,t)=>{let s={};return t&&(s._=t),`${this.getTeamRoute(e)}/image${o.buildQueryString(s)}`},this.setTeamIcon=(e,t)=>{this.trackEvent(\"api\",\"api_team_set_team_icon\");let s=new n.default;s.append(\"image\",t);let i={method:\"post\",body:s};return s.getBoundary&&(i.headers={\"Content-Type\":`multipart/form-data; boundary=${s.getBoundary()}`}),this.doFetch(`${this.getTeamRoute(e)}/image`,i)},this.removeTeamIcon=e=>(this.trackEvent(\"api\",\"api_team_remove_team_icon\"),this.doFetch(`${this.getTeamRoute(e)}/image`,{method:\"delete\"})),this.updateTeamMemberSchemeRoles=(e,t,s,i)=>{let a={scheme_user:s,scheme_admin:i};return this.doFetch(`${this.getTeamRoute(e)}/members/${t}/schemeRoles`,{method:\"put\",body:JSON.stringify(a)})},this.getAllChannels=(e=0,t=d,s=\"\",i=!1,a=!1,c=!1,g=!1)=>{let y={page:e,per_page:t,not_associated_to_group:s,exclude_default_channels:i,include_total_count:a,include_deleted:c,exclude_policy_constrained:g};return this.doFetch(`${this.getChannelsRoute()}${o.buildQueryString(y)}`,{method:\"get\"})},this.createChannel=e=>(this.trackEvent(\"api\",\"api_channels_create\",{team_id:e.team_id}),this.doFetch(`${this.getChannelsRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.createDirectChannel=e=>(this.trackEvent(\"api\",\"api_channels_create_direct\"),this.doFetch(`${this.getChannelsRoute()}/direct`,{method:\"post\",body:JSON.stringify(e)})),this.createGroupChannel=e=>(this.trackEvent(\"api\",\"api_channels_create_group\"),this.doFetch(`${this.getChannelsRoute()}/group`,{method:\"post\",body:JSON.stringify(e)})),this.deleteChannel=e=>(this.trackEvent(\"api\",\"api_channels_delete\",{channel_id:e}),this.doFetch(`${this.getChannelRoute(e)}`,{method:\"delete\"})),this.unarchiveChannel=e=>(this.trackEvent(\"api\",\"api_channels_unarchive\",{channel_id:e}),this.doFetch(`${this.getChannelRoute(e)}/restore`,{method:\"post\"})),this.updateChannel=e=>(this.trackEvent(\"api\",\"api_channels_update\",{channel_id:e.id}),this.doFetch(`${this.getChannelRoute(e.id)}`,{method:\"put\",body:JSON.stringify(e)})),this.updateChannelPrivacy=(e,t)=>(this.trackEvent(\"api\",\"api_channels_update_privacy\",{channel_id:e,privacy:t}),this.doFetch(`${this.getChannelRoute(e)}/privacy`,{method:\"put\",body:JSON.stringify({privacy:t})})),this.patchChannel=(e,t)=>(this.trackEvent(\"api\",\"api_channels_patch\",{channel_id:e}),this.doFetch(`${this.getChannelRoute(e)}/patch`,{method:\"put\",body:JSON.stringify(t)})),this.updateChannelNotifyProps=e=>(this.trackEvent(\"api\",\"api_users_update_channel_notifications\",{channel_id:e.channel_id}),this.doFetch(`${this.getChannelMemberRoute(e.channel_id,e.user_id)}/notify_props`,{method:\"put\",body:JSON.stringify(e)})),this.updateChannelScheme=(e,t)=>{let s={scheme_id:t};return this.trackEvent(\"api\",\"api_channels_update_scheme\",Object.assign({channel_id:e},s)),this.doFetch(`${this.getChannelSchemeRoute(e)}`,{method:\"put\",body:JSON.stringify(s)})},this.getChannel=e=>this.doFetch(`${this.getChannelRoute(e)}`,{method:\"get\"}),this.getChannelByName=(e,t,s=!1)=>this.doFetch(`${this.getTeamRoute(e)}/channels/name/${t}?include_deleted=${s}`,{method:\"get\"}),this.getChannelByNameAndTeamName=(e,t,s=!1)=>this.doFetch(`${this.getTeamNameRoute(e)}/channels/name/${t}?include_deleted=${s}`,{method:\"get\"}),this.getChannels=(e,t=0,s=d)=>this.doFetch(`${this.getTeamRoute(e)}/channels${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getAllTeamsChannels=()=>this.doFetch(`${this.getUsersRoute()}/me/channels`,{method:\"get\"}),this.getArchivedChannels=(e,t=0,s=d)=>this.doFetch(`${this.getTeamRoute(e)}/channels/deleted${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getMyChannels=(e,t=!1)=>this.doFetch(`${this.getUserRoute(\"me\")}/teams/${e}/channels${o.buildQueryString({include_deleted:t})}`,{method:\"get\"}),this.getAllChannelsMembers=(e,t=0,s=d)=>this.doFetch(`${this.getUserRoute(e)}/channel_members${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getMyChannelMember=e=>this.doFetch(`${this.getChannelMemberRoute(e,\"me\")}`,{method:\"get\"}),this.getMyChannelMembers=e=>this.doFetch(`${this.getUserRoute(\"me\")}/teams/${e}/channels/members`,{method:\"get\"}),this.getChannelMembers=(e,t=0,s=d)=>this.doFetch(`${this.getChannelMembersRoute(e)}${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getChannelTimezones=e=>this.doFetch(`${this.getChannelRoute(e)}/timezones`,{method:\"get\"}),this.getChannelMember=(e,t)=>this.doFetch(`${this.getChannelMemberRoute(e,t)}`,{method:\"get\"}),this.getChannelMembersByIds=(e,t)=>this.doFetch(`${this.getChannelMembersRoute(e)}/ids`,{method:\"post\",body:JSON.stringify(t)}),this.addToChannel=(e,t,s=\"\")=>{this.trackEvent(\"api\",\"api_channels_add_member\",{channel_id:t});let i={user_id:e,channel_id:t,post_root_id:s};return this.doFetch(`${this.getChannelMembersRoute(t)}`,{method:\"post\",body:JSON.stringify(i)})},this.removeFromChannel=(e,t)=>(this.trackEvent(\"api\",\"api_channels_remove_member\",{channel_id:t}),this.doFetch(`${this.getChannelMemberRoute(t,e)}`,{method:\"delete\"})),this.updateChannelMemberRoles=(e,t,s)=>this.doFetch(`${this.getChannelMemberRoute(e,t)}/roles`,{method:\"put\",body:JSON.stringify({roles:s})}),this.getChannelStats=e=>this.doFetch(`${this.getChannelRoute(e)}/stats`,{method:\"get\"}),this.getChannelModerations=e=>this.doFetch(`${this.getChannelRoute(e)}/moderations`,{method:\"get\"}),this.patchChannelModerations=(e,t)=>this.doFetch(`${this.getChannelRoute(e)}/moderations/patch`,{method:\"put\",body:JSON.stringify(t)}),this.getChannelMemberCountsByGroup=(e,t)=>this.doFetch(`${this.getChannelRoute(e)}/member_counts_by_group?include_timezones=${t}`,{method:\"get\"}),this.viewMyChannel=(e,t)=>{let s={channel_id:e,prev_channel_id:t,collapsed_threads_supported:!0};return this.doFetch(`${this.getChannelsRoute()}/members/me/view`,{method:\"post\",body:JSON.stringify(s)})},this.autocompleteChannels=(e,t)=>this.doFetch(`${this.getTeamRoute(e)}/channels/autocomplete${o.buildQueryString({name:t})}`,{method:\"get\"}),this.autocompleteChannelsForSearch=(e,t)=>this.doFetch(`${this.getTeamRoute(e)}/channels/search_autocomplete${o.buildQueryString({name:t})}`,{method:\"get\"}),this.searchChannels=(e,t)=>this.doFetch(`${this.getTeamRoute(e)}/channels/search`,{method:\"post\",body:JSON.stringify({term:t})}),this.searchArchivedChannels=(e,t)=>this.doFetch(`${this.getTeamRoute(e)}/channels/search_archived`,{method:\"post\",body:JSON.stringify({term:t})}),this.searchAllChannels=(e,t={})=>{let s=Object.assign({term:e},t),i=Boolean(t.include_deleted),a=Boolean(t.nonAdminSearch),c={include_deleted:i};return a&&(c={system_console:!1},delete s.nonAdminSearch),this.doFetch(`${this.getChannelsRoute()}/search${o.buildQueryString(c)}`,{method:\"post\",body:JSON.stringify(s)})},this.searchGroupChannels=e=>this.doFetch(`${this.getChannelsRoute()}/group/search`,{method:\"post\",body:JSON.stringify({term:e})}),this.updateChannelMemberSchemeRoles=(e,t,s,i)=>{let a={scheme_user:s,scheme_admin:i};return this.doFetch(`${this.getChannelRoute(e)}/members/${t}/schemeRoles`,{method:\"put\",body:JSON.stringify(a)})},this.getChannelCategories=(e,t)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}`,{method:\"get\"}),this.createChannelCategory=(e,t,s)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}`,{method:\"post\",body:JSON.stringify(s)}),this.updateChannelCategories=(e,t,s)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}`,{method:\"put\",body:JSON.stringify(s)}),this.getChannelCategoryOrder=(e,t)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}/order`,{method:\"get\"}),this.updateChannelCategoryOrder=(e,t,s)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}/order`,{method:\"put\",body:JSON.stringify(s)}),this.getChannelCategory=(e,t,s)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}/${s}`,{method:\"get\"}),this.updateChannelCategory=(e,t,s)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}/${s.id}`,{method:\"put\",body:JSON.stringify(s)}),this.deleteChannelCategory=(e,t,s)=>this.doFetch(`${this.getChannelCategoriesRoute(e,t)}/${s}`,{method:\"delete\"}),this.createPost=e=>r(this,void 0,void 0,function*(){let t=yield this.doFetch(`${this.getPostsRoute()}`,{method:\"post\",body:JSON.stringify(e)}),s={channel_id:t.channel_id,post_id:t.id,user_actual_id:t.user_id,root_id:t.root_id};return this.trackEvent(\"api\",\"api_posts_create\",s),t.root_id!=null&&t.root_id!==\"\"&&this.trackEvent(\"api\",\"api_posts_replied\",s),t}),this.updatePost=e=>(this.trackEvent(\"api\",\"api_posts_update\",{channel_id:e.channel_id,post_id:e.id}),this.doFetch(`${this.getPostRoute(e.id)}`,{method:\"put\",body:JSON.stringify(e)})),this.getPost=e=>this.doFetch(`${this.getPostRoute(e)}`,{method:\"get\"}),this.patchPost=e=>(this.trackEvent(\"api\",\"api_posts_patch\",{channel_id:e.channel_id,post_id:e.id}),this.doFetch(`${this.getPostRoute(e.id)}/patch`,{method:\"put\",body:JSON.stringify(e)})),this.deletePost=e=>(this.trackEvent(\"api\",\"api_posts_delete\"),this.doFetch(`${this.getPostRoute(e)}`,{method:\"delete\"})),this.getPostThread=(e,t=!0,s=!1,i=!1)=>this.getPaginatedPostThread(e,{fetchThreads:t,collapsedThreads:s,collapsedThreadsExtended:i}),this.getPaginatedPostThread=(e,t)=>r(this,void 0,void 0,function*(){let{fetchThreads:s=!0,collapsedThreads:i=!1,collapsedThreadsExtended:a=!1,direction:c=\"down\",fetchAll:g=!1,perPage:y=g?void 0:d}=t,f=u(t,[\"fetchThreads\",\"collapsedThreads\",\"collapsedThreadsExtended\",\"direction\",\"fetchAll\",\"perPage\"]);return this.doFetch(`${this.getPostRoute(e)}/thread${o.buildQueryString(Object.assign({skipFetchThreads:!s,collapsedThreads:i,collapsedThreadsExtended:a,direction:c,perPage:y},f))}`,{method:\"get\"})}),this.getPosts=(e,t=0,s=d,i=!0,a=!1,c=!1)=>this.doFetch(`${this.getChannelRoute(e)}/posts${o.buildQueryString({page:t,per_page:s,skipFetchThreads:!i,collapsedThreads:a,collapsedThreadsExtended:c})}`,{method:\"get\"}),this.getPostsUnread=(e,t,s=h.DEFAULT_LIMIT_AFTER,i=h.DEFAULT_LIMIT_BEFORE,a=!0,c=!1,g=!1)=>this.doFetch(`${this.getUserRoute(t)}/channels/${e}/posts/unread${o.buildQueryString({limit_after:s,limit_before:i,skipFetchThreads:!a,collapsedThreads:c,collapsedThreadsExtended:g})}`,{method:\"get\"}),this.getPostsSince=(e,t,s=!0,i=!1,a=!1)=>this.doFetch(`${this.getChannelRoute(e)}/posts${o.buildQueryString({since:t,skipFetchThreads:!s,collapsedThreads:i,collapsedThreadsExtended:a})}`,{method:\"get\"}),this.getPostsBefore=(e,t,s=0,i=d,a=!0,c=!1,g=!1)=>this.doFetch(`${this.getChannelRoute(e)}/posts${o.buildQueryString({before:t,page:s,per_page:i,skipFetchThreads:!a,collapsedThreads:c,collapsedThreadsExtended:g})}`,{method:\"get\"}),this.getPostsAfter=(e,t,s=0,i=d,a=!0,c=!1,g=!1)=>this.doFetch(`${this.getChannelRoute(e)}/posts${o.buildQueryString({after:t,page:s,per_page:i,skipFetchThreads:!a,collapsedThreads:c,collapsedThreadsExtended:g})}`,{method:\"get\"}),this.getUserThreads=(e=\"me\",t,{before:s=\"\",after:i=\"\",perPage:a=d,extended:c=!1,deleted:g=!1,unread:y=!1,since:f=0,totalsOnly:v=!1,threadsOnly:F=!1})=>this.doFetch(`${this.getUserThreadsRoute(e,t)}${o.buildQueryString({before:s,after:i,per_page:a,extended:c,deleted:g,unread:y,since:f,totalsOnly:v,threadsOnly:F})}`,{method:\"get\"}),this.getUserThread=(e,t,s,i=!1)=>{let a=`${this.getUserThreadRoute(e,t,s)}`;return this.doFetch(`${a}${o.buildQueryString({extended:i})}`,{method:\"get\"})},this.updateThreadsReadForUser=(e,t)=>{let s=`${this.getUserThreadsRoute(e,t)}/read`;return this.doFetch(s,{method:\"put\"})},this.updateThreadReadForUser=(e,t,s,i)=>{let a=`${this.getUserThreadRoute(e,t,s)}/read/${i}`;return this.doFetch(a,{method:\"put\"})},this.markThreadAsUnreadForUser=(e,t,s,i)=>{let a=`${this.getUserThreadRoute(e,t,s)}/set_unread/${i}`;return this.doFetch(a,{method:\"post\"})},this.updateThreadFollowForUser=(e,t,s,i)=>{let a=this.getUserThreadRoute(e,t,s)+\"/following\";return this.doFetch(a,{method:i?\"put\":\"delete\"})},this.getFileInfosForPost=e=>this.doFetch(`${this.getPostRoute(e)}/files/info`,{method:\"get\"}),this.getFlaggedPosts=(e,t=\"\",s=\"\",i=0,a=d)=>(this.trackEvent(\"api\",\"api_posts_get_flagged\",{team_id:s}),this.doFetch(`${this.getUserRoute(e)}/posts/flagged${o.buildQueryString({channel_id:t,team_id:s,page:i,per_page:a})}`,{method:\"get\"})),this.getPinnedPosts=e=>(this.trackEvent(\"api\",\"api_posts_get_pinned\",{channel_id:e}),this.doFetch(`${this.getChannelRoute(e)}/pinned`,{method:\"get\"})),this.markPostAsUnread=(e,t)=>(this.trackEvent(\"api\",\"api_post_set_unread_post\"),this.doFetch(`${this.getUserRoute(e)}/posts/${t}/set_unread`,{method:\"post\",body:JSON.stringify({collapsed_threads_supported:!0})})),this.pinPost=e=>(this.trackEvent(\"api\",\"api_posts_pin\"),this.doFetch(`${this.getPostRoute(e)}/pin`,{method:\"post\"})),this.unpinPost=e=>(this.trackEvent(\"api\",\"api_posts_unpin\"),this.doFetch(`${this.getPostRoute(e)}/unpin`,{method:\"post\"})),this.getPostsByIds=e=>this.doFetch(`${this.getPostsRoute()}/ids`,{method:\"post\",body:JSON.stringify(e)}),this.addReaction=(e,t,s)=>(this.trackEvent(\"api\",\"api_reactions_save\",{post_id:t}),this.doFetch(`${this.getReactionsRoute()}`,{method:\"post\",body:JSON.stringify({user_id:e,post_id:t,emoji_name:s})})),this.removeReaction=(e,t,s)=>(this.trackEvent(\"api\",\"api_reactions_delete\",{post_id:t}),this.doFetch(`${this.getUserRoute(e)}/posts/${t}/reactions/${s}`,{method:\"delete\"})),this.getReactionsForPost=e=>this.doFetch(`${this.getPostRoute(e)}/reactions`,{method:\"get\"}),this.getTopReactionsForTeam=(e,t,s,i)=>this.doFetch(`${this.getTeamRoute(e)}/top/reactions${o.buildQueryString({page:t,per_page:s,time_range:i})}`,{method:\"get\"}),this.getMyTopReactions=(e,t,s,i)=>this.doFetch(`${this.getUsersRoute()}/me/top/reactions${o.buildQueryString({page:t,per_page:s,time_range:i,team_id:e})}`,{method:\"get\"}),this.getTopChannelsForTeam=(e,t,s,i)=>this.doFetch(`${this.getTeamRoute(e)}/top/channels${o.buildQueryString({page:t,per_page:s,time_range:i})}`,{method:\"get\"}),this.getMyTopChannels=(e,t,s,i)=>this.doFetch(`${this.getUsersRoute()}/me/top/channels${o.buildQueryString({page:t,per_page:s,time_range:i,team_id:e})}`,{method:\"get\"}),this.getTopThreadsForTeam=(e,t,s,i)=>this.doFetch(`${this.getTeamRoute(e)}/top/threads${o.buildQueryString({page:t,per_page:s,time_range:i})}`,{method:\"get\"}),this.getMyTopThreads=(e,t,s,i)=>this.doFetch(`${this.getUsersRoute()}/me/top/threads${o.buildQueryString({page:t,per_page:s,time_range:i,team_id:e})}`,{method:\"get\"}),this.getLeastActiveChannelsForTeam=(e,t,s,i)=>this.doFetch(`${this.getTeamRoute(e)}/top/inactive_channels${o.buildQueryString({page:t,per_page:s,time_range:i})}`,{method:\"get\"}),this.getMyTopDMs=(e,t,s,i)=>this.doFetch(`${this.getUsersRoute()}/me/top/dms${o.buildQueryString({page:t,per_page:s,time_range:i,team_id:e})}`,{method:\"get\"}),this.getMyLeastActiveChannels=(e,t,s,i)=>this.doFetch(`${this.getUsersRoute()}/me/top/inactive_channels${o.buildQueryString({page:t,per_page:s,time_range:i,team_id:e})}`,{method:\"get\"}),this.getNewTeamMembers=(e,t,s,i)=>this.doFetch(`${this.getTeamRoute(e)}/top/team_members${o.buildQueryString({page:t,per_page:s,time_range:i})}`,{method:\"get\"}),this.searchPostsWithParams=(e,t)=>{this.trackEvent(\"api\",\"api_posts_search\",{team_id:e});let s=`${this.getPostsRoute()}/search`;return e&&(s=`${this.getTeamRoute(e)}/posts/search`),this.doFetch(s,{method:\"post\",body:JSON.stringify(t)})},this.searchPosts=(e,t,s)=>this.searchPostsWithParams(e,{terms:t,is_or_search:s}),this.searchFilesWithParams=(e,t)=>(this.trackEvent(\"api\",\"api_files_search\",{team_id:e}),this.doFetch(`${this.getTeamRoute(e)}/files/search`,{method:\"post\",body:JSON.stringify(t)})),this.searchFiles=(e,t,s)=>this.searchFilesWithParams(e,{terms:t,is_or_search:s}),this.getOpenGraphMetadata=e=>this.doFetch(`${this.getBaseRoute()}/opengraph`,{method:\"post\",body:JSON.stringify({url:e})}),this.doPostAction=(e,t,s=\"\")=>this.doPostActionWithCookie(e,t,\"\",s),this.doPostActionWithCookie=(e,t,s,i=\"\")=>{i?this.trackEvent(\"api\",\"api_interactive_messages_menu_selected\"):this.trackEvent(\"api\",\"api_interactive_messages_button_clicked\");let a={selected_option:i};return s!==\"\"&&(a.cookie=s),this.doFetch(`${this.getPostRoute(e)}/actions/${encodeURIComponent(t)}`,{method:\"post\",body:JSON.stringify(a)})},this.uploadFile=(e,t)=>{this.trackEvent(\"api\",\"api_files_upload\");let s={method:\"post\",body:e};return t&&(s.headers={\"Content-Type\":`multipart/form-data; boundary=${t}`}),this.doFetch(`${this.getFilesRoute()}`,s)},this.getFilePublicLink=e=>this.doFetch(`${this.getFileRoute(e)}/link`,{method:\"get\"}),this.savePreferences=(e,t)=>this.doFetch(`${this.getPreferencesRoute(e)}`,{method:\"put\",body:JSON.stringify(t)}),this.getMyPreferences=()=>this.doFetch(`${this.getPreferencesRoute(\"me\")}`,{method:\"get\"}),this.deletePreferences=(e,t)=>this.doFetch(`${this.getPreferencesRoute(e)}/delete`,{method:\"post\",body:JSON.stringify(t)}),this.ping=()=>this.doFetch(`${this.getBaseRoute()}/system/ping?time=${Date.now()}`,{method:\"get\"}),this.upgradeToEnterprise=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getBaseRoute()}/upgrade_to_enterprise`,{method:\"post\"})}),this.upgradeToEnterpriseStatus=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getBaseRoute()}/upgrade_to_enterprise/status`,{method:\"get\"})}),this.restartServer=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getBaseRoute()}/restart`,{method:\"post\"})}),this.logClientError=(e,t=b.LogLevel.Error)=>{let s=`${this.getBaseRoute()}/logs`;if(!this.enableLogging)throw new E(this.getUrl(),{message:\"Logging disabled.\",url:s});return this.doFetch(s,{method:\"post\",body:JSON.stringify({message:e,level:t})})},this.getClientConfigOld=()=>this.doFetch(`${this.getBaseRoute()}/config/client?format=old`,{method:\"get\"}),this.getClientLicenseOld=()=>this.doFetch(`${this.getBaseRoute()}/license/client?format=old`,{method:\"get\"}),this.getWarnMetricsStatus=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getBaseRoute()}/warn_metrics/status`,{method:\"get\"})}),this.sendWarnMetricAck=(e,t)=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getBaseRoute()}/warn_metrics/ack/${encodeURI(e)}`,{method:\"post\",body:JSON.stringify({forceAck:t})})}),this.setFirstAdminVisitMarketplaceStatus=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getPluginsRoute()}/marketplace/first_admin_visit`,{method:\"post\",body:JSON.stringify({first_admin_visit_marketplace_status:!0})})}),this.getFirstAdminVisitMarketplaceStatus=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getPluginsRoute()}/marketplace/first_admin_visit`,{method:\"get\"})}),this.getFirstAdminSetupComplete=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getSystemRoute()}/onboarding/complete`,{method:\"get\"})}),this.getTranslations=e=>this.doFetch(e,{method:\"get\"}),this.getWebSocketUrl=()=>`${this.getBaseRoute()}/websocket`,this.createIncomingWebhook=e=>(this.trackEvent(\"api\",\"api_integrations_created\",{team_id:e.team_id}),this.doFetch(`${this.getIncomingHooksRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.getIncomingWebhook=e=>this.doFetch(`${this.getIncomingHookRoute(e)}`,{method:\"get\"}),this.getIncomingWebhooks=(e=\"\",t=0,s=d)=>{let i={page:t,per_page:s};return e&&(i.team_id=e),this.doFetch(`${this.getIncomingHooksRoute()}${o.buildQueryString(i)}`,{method:\"get\"})},this.removeIncomingWebhook=e=>(this.trackEvent(\"api\",\"api_integrations_deleted\"),this.doFetch(`${this.getIncomingHookRoute(e)}`,{method:\"delete\"})),this.updateIncomingWebhook=e=>(this.trackEvent(\"api\",\"api_integrations_updated\",{team_id:e.team_id}),this.doFetch(`${this.getIncomingHookRoute(e.id)}`,{method:\"put\",body:JSON.stringify(e)})),this.createOutgoingWebhook=e=>(this.trackEvent(\"api\",\"api_integrations_created\",{team_id:e.team_id}),this.doFetch(`${this.getOutgoingHooksRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.getOutgoingWebhook=e=>this.doFetch(`${this.getOutgoingHookRoute(e)}`,{method:\"get\"}),this.getOutgoingWebhooks=(e=\"\",t=\"\",s=0,i=d)=>{let a={page:s,per_page:i};return e&&(a.channel_id=e),t&&(a.team_id=t),this.doFetch(`${this.getOutgoingHooksRoute()}${o.buildQueryString(a)}`,{method:\"get\"})},this.removeOutgoingWebhook=e=>(this.trackEvent(\"api\",\"api_integrations_deleted\"),this.doFetch(`${this.getOutgoingHookRoute(e)}`,{method:\"delete\"})),this.updateOutgoingWebhook=e=>(this.trackEvent(\"api\",\"api_integrations_updated\",{team_id:e.team_id}),this.doFetch(`${this.getOutgoingHookRoute(e.id)}`,{method:\"put\",body:JSON.stringify(e)})),this.regenOutgoingHookToken=e=>this.doFetch(`${this.getOutgoingHookRoute(e)}/regen_token`,{method:\"post\"}),this.getCommandsList=e=>this.doFetch(`${this.getCommandsRoute()}?team_id=${e}`,{method:\"get\"}),this.getCommandAutocompleteSuggestionsList=(e,t,s)=>this.doFetch(`${this.getTeamRoute(t)}/commands/autocomplete_suggestions${o.buildQueryString(Object.assign(Object.assign({},s),{user_input:e}))}`,{method:\"get\"}),this.getAutocompleteCommandsList=(e,t=0,s=d)=>this.doFetch(`${this.getTeamRoute(e)}/commands/autocomplete${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getCustomTeamCommands=e=>this.doFetch(`${this.getCommandsRoute()}?team_id=${e}&custom_only=true`,{method:\"get\"}),this.executeCommand=(e,t)=>(this.trackEvent(\"api\",\"api_integrations_used\"),this.doFetch(`${this.getCommandsRoute()}/execute`,{method:\"post\",body:JSON.stringify(Object.assign({command:e},t))})),this.addCommand=e=>(this.trackEvent(\"api\",\"api_integrations_created\"),this.doFetch(`${this.getCommandsRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.editCommand=e=>(this.trackEvent(\"api\",\"api_integrations_created\"),this.doFetch(`${this.getCommandsRoute()}/${e.id}`,{method:\"put\",body:JSON.stringify(e)})),this.regenCommandToken=e=>this.doFetch(`${this.getCommandsRoute()}/${e}/regen_token`,{method:\"put\"}),this.deleteCommand=e=>(this.trackEvent(\"api\",\"api_integrations_deleted\"),this.doFetch(`${this.getCommandsRoute()}/${e}`,{method:\"delete\"})),this.createOAuthApp=e=>(this.trackEvent(\"api\",\"api_apps_register\"),this.doFetch(`${this.getOAuthAppsRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.editOAuthApp=e=>this.doFetch(`${this.getOAuthAppsRoute()}/${e.id}`,{method:\"put\",body:JSON.stringify(e)}),this.getOAuthApps=(e=0,t=d)=>this.doFetch(`${this.getOAuthAppsRoute()}${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.getAppsOAuthAppIDs=()=>this.doFetch(`${this.getAppsProxyRoute()}/api/v1/oauth-app-ids`,{method:\"get\"}),this.getAppsBotIDs=()=>this.doFetch(`${this.getAppsProxyRoute()}/api/v1/bot-ids`,{method:\"get\"}),this.getOAuthApp=e=>this.doFetch(`${this.getOAuthAppRoute(e)}`,{method:\"get\"}),this.getOAuthAppInfo=e=>this.doFetch(`${this.getOAuthAppRoute(e)}/info`,{method:\"get\"}),this.deleteOAuthApp=e=>(this.trackEvent(\"api\",\"api_apps_delete\"),this.doFetch(`${this.getOAuthAppRoute(e)}`,{method:\"delete\"})),this.regenOAuthAppSecret=e=>this.doFetch(`${this.getOAuthAppRoute(e)}/regen_secret`,{method:\"post\"}),this.submitInteractiveDialog=e=>(this.trackEvent(\"api\",\"api_interactive_messages_dialog_submitted\"),this.doFetch(`${this.getBaseRoute()}/actions/dialogs/submit`,{method:\"post\",body:JSON.stringify(e)})),this.createCustomEmoji=(e,t)=>{this.trackEvent(\"api\",\"api_emoji_custom_add\");let s=new n.default;s.append(\"image\",t),s.append(\"emoji\",JSON.stringify(e));let i={method:\"post\",body:s};return s.getBoundary&&(i.headers={\"Content-Type\":`multipart/form-data; boundary=${s.getBoundary()}`}),this.doFetch(`${this.getEmojisRoute()}`,i)},this.getCustomEmoji=e=>this.doFetch(`${this.getEmojisRoute()}/${e}`,{method:\"get\"}),this.getCustomEmojiByName=e=>this.doFetch(`${this.getEmojisRoute()}/name/${e}`,{method:\"get\"}),this.getCustomEmojis=(e=0,t=d,s=\"\")=>this.doFetch(`${this.getEmojisRoute()}${o.buildQueryString({page:e,per_page:t,sort:s})}`,{method:\"get\"}),this.deleteCustomEmoji=e=>(this.trackEvent(\"api\",\"api_emoji_custom_delete\"),this.doFetch(`${this.getEmojiRoute(e)}`,{method:\"delete\"})),this.getSystemEmojiImageUrl=e=>{let t=e.endsWith(\".png\")?\"\":\".png\";return`${this.url}/static/emoji/${e}${t}`},this.getCustomEmojiImageUrl=e=>`${this.getEmojiRoute(e)}/image`,this.searchCustomEmoji=(e,t={})=>this.doFetch(`${this.getEmojisRoute()}/search`,{method:\"post\",body:JSON.stringify(Object.assign({term:e},t))}),this.autocompleteCustomEmoji=e=>this.doFetch(`${this.getEmojisRoute()}/autocomplete${o.buildQueryString({name:e})}`,{method:\"get\"}),this.getDataRetentionPolicy=()=>this.doFetch(`${this.getDataRetentionRoute()}/policy`,{method:\"get\"}),this.getDataRetentionCustomPolicies=(e=0,t=d)=>this.doFetch(`${this.getDataRetentionRoute()}/policies${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.getDataRetentionCustomPolicy=e=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}`,{method:\"get\"}),this.deleteDataRetentionCustomPolicy=e=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}`,{method:\"delete\"}),this.searchDataRetentionCustomPolicyChannels=(e,t,s)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/channels/search`,{method:\"post\",body:JSON.stringify(Object.assign({term:t},s))}),this.searchDataRetentionCustomPolicyTeams=(e,t,s)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/teams/search`,{method:\"post\",body:JSON.stringify(Object.assign({term:t},s))}),this.getDataRetentionCustomPolicyTeams=(e,t=0,s=d)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/teams${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getDataRetentionCustomPolicyChannels=(e,t=0,s=d)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/channels${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.createDataRetentionPolicy=e=>this.doFetch(`${this.getDataRetentionRoute()}/policies`,{method:\"post\",body:JSON.stringify(e)}),this.updateDataRetentionPolicy=(e,t)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}`,{method:\"PATCH\",body:JSON.stringify(t)}),this.addDataRetentionPolicyTeams=(e,t)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/teams`,{method:\"post\",body:JSON.stringify(t)}),this.removeDataRetentionPolicyTeams=(e,t)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/teams`,{method:\"delete\",body:JSON.stringify(t)}),this.addDataRetentionPolicyChannels=(e,t)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/channels`,{method:\"post\",body:JSON.stringify(t)}),this.removeDataRetentionPolicyChannels=(e,t)=>this.doFetch(`${this.getDataRetentionRoute()}/policies/${e}/channels`,{method:\"delete\",body:JSON.stringify(t)}),this.getJob=e=>this.doFetch(`${this.getJobsRoute()}/${e}`,{method:\"get\"}),this.getJobs=(e=0,t=d)=>this.doFetch(`${this.getJobsRoute()}${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.getJobsByType=(e,t=0,s=d)=>this.doFetch(`${this.getJobsRoute()}/type/${e}${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.createJob=e=>this.doFetch(`${this.getJobsRoute()}`,{method:\"post\",body:JSON.stringify(e)}),this.cancelJob=e=>this.doFetch(`${this.getJobsRoute()}/${e}/cancel`,{method:\"post\"}),this.getLogs=(e=0,t=Y)=>this.doFetch(`${this.getBaseRoute()}/logs${o.buildQueryString({page:e,logs_per_page:t})}`,{method:\"get\"}),this.getAudits=(e=0,t=d)=>this.doFetch(`${this.getBaseRoute()}/audits${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.getConfig=()=>this.doFetch(`${this.getBaseRoute()}/config`,{method:\"get\"}),this.updateConfig=e=>this.doFetch(`${this.getBaseRoute()}/config`,{method:\"put\",body:JSON.stringify(e)}),this.patchConfig=e=>this.doFetch(`${this.getBaseRoute()}/config/patch`,{method:\"put\",body:JSON.stringify(e)}),this.reloadConfig=()=>this.doFetch(`${this.getBaseRoute()}/config/reload`,{method:\"post\"}),this.getEnvironmentConfig=()=>this.doFetch(`${this.getBaseRoute()}/config/environment`,{method:\"get\"}),this.testEmail=e=>this.doFetch(`${this.getBaseRoute()}/email/test`,{method:\"post\",body:JSON.stringify(e)}),this.testSiteURL=e=>this.doFetch(`${this.getBaseRoute()}/site_url/test`,{method:\"post\",body:JSON.stringify({site_url:e})}),this.testS3Connection=e=>this.doFetch(`${this.getBaseRoute()}/file/s3_test`,{method:\"post\",body:JSON.stringify(e)}),this.invalidateCaches=()=>this.doFetch(`${this.getBaseRoute()}/caches/invalidate`,{method:\"post\"}),this.recycleDatabase=()=>this.doFetch(`${this.getBaseRoute()}/database/recycle`,{method:\"post\"}),this.createComplianceReport=e=>this.doFetch(`${this.getBaseRoute()}/compliance/reports`,{method:\"post\",body:JSON.stringify(e)}),this.getComplianceReport=e=>this.doFetch(`${this.getBaseRoute()}/compliance/reports/${e}`,{method:\"get\"}),this.getComplianceReports=(e=0,t=d)=>this.doFetch(`${this.getBaseRoute()}/compliance/reports${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.uploadBrandImage=e=>{let t=new n.default;t.append(\"image\",e);let s={method:\"post\",body:t};return t.getBoundary&&(s.headers={\"Content-Type\":`multipart/form-data; boundary=${t.getBoundary()}`}),this.doFetch(`${this.getBrandRoute()}/image`,s)},this.deleteBrandImage=()=>this.doFetch(`${this.getBrandRoute()}/image`,{method:\"delete\"}),this.getClusterStatus=()=>this.doFetch(`${this.getBaseRoute()}/cluster/status`,{method:\"get\"}),this.testLdap=()=>this.doFetch(`${this.getBaseRoute()}/ldap/test`,{method:\"post\"}),this.syncLdap=()=>this.doFetch(`${this.getBaseRoute()}/ldap/sync`,{method:\"post\"}),this.getLdapGroups=(e=0,t=d,s={})=>{let i=Object.assign({page:e,per_page:t},s);return this.doFetch(`${this.getBaseRoute()}/ldap/groups${o.buildQueryString(i)}`,{method:\"get\"})},this.linkLdapGroup=e=>this.doFetch(`${this.getBaseRoute()}/ldap/groups/${encodeURI(e)}/link`,{method:\"post\"}),this.unlinkLdapGroup=e=>this.doFetch(`${this.getBaseRoute()}/ldap/groups/${encodeURI(e)}/link`,{method:\"delete\"}),this.getSamlCertificateStatus=()=>this.doFetch(`${this.getBaseRoute()}/saml/certificate/status`,{method:\"get\"}),this.uploadPublicSamlCertificate=e=>{let t=new n.default;return t.append(\"certificate\",e),this.doFetch(`${this.getBaseRoute()}/saml/certificate/public`,{method:\"post\",body:t})},this.uploadPrivateSamlCertificate=e=>{let t=new n.default;return t.append(\"certificate\",e),this.doFetch(`${this.getBaseRoute()}/saml/certificate/private`,{method:\"post\",body:t})},this.uploadPublicLdapCertificate=e=>{let t=new n.default;return t.append(\"certificate\",e),this.doFetch(`${this.getBaseRoute()}/ldap/certificate/public`,{method:\"post\",body:t})},this.uploadPrivateLdapCertificate=e=>{let t=new n.default;return t.append(\"certificate\",e),this.doFetch(`${this.getBaseRoute()}/ldap/certificate/private`,{method:\"post\",body:t})},this.uploadIdpSamlCertificate=e=>{let t=new n.default;return t.append(\"certificate\",e),this.doFetch(`${this.getBaseRoute()}/saml/certificate/idp`,{method:\"post\",body:t})},this.deletePublicSamlCertificate=()=>this.doFetch(`${this.getBaseRoute()}/saml/certificate/public`,{method:\"delete\"}),this.deletePrivateSamlCertificate=()=>this.doFetch(`${this.getBaseRoute()}/saml/certificate/private`,{method:\"delete\"}),this.deletePublicLdapCertificate=()=>this.doFetch(`${this.getBaseRoute()}/ldap/certificate/public`,{method:\"delete\"}),this.deletePrivateLdapCertificate=()=>this.doFetch(`${this.getBaseRoute()}/ldap/certificate/private`,{method:\"delete\"}),this.deleteIdpSamlCertificate=()=>this.doFetch(`${this.getBaseRoute()}/saml/certificate/idp`,{method:\"delete\"}),this.testElasticsearch=e=>this.doFetch(`${this.getBaseRoute()}/elasticsearch/test`,{method:\"post\",body:JSON.stringify(e)}),this.purgeElasticsearchIndexes=()=>this.doFetch(`${this.getBaseRoute()}/elasticsearch/purge_indexes`,{method:\"post\"}),this.purgeBleveIndexes=()=>this.doFetch(`${this.getBaseRoute()}/bleve/purge_indexes`,{method:\"post\"}),this.uploadLicense=e=>{this.trackEvent(\"api\",\"api_license_upload\");let t=new n.default;t.append(\"license\",e);let s={method:\"post\",body:t};return t.getBoundary&&(s.headers={\"Content-Type\":`multipart/form-data; boundary=${t.getBoundary()}`}),this.doFetch(`${this.getBaseRoute()}/license`,s)},this.requestTrialLicense=e=>this.doFetchWithResponse(`${this.getBaseRoute()}/trial-license`,{method:\"POST\",body:JSON.stringify(e)}),this.removeLicense=()=>this.doFetch(`${this.getBaseRoute()}/license`,{method:\"delete\"}),this.getPrevTrialLicense=()=>this.doFetch(`${this.getBaseRoute()}/trial-license/prev`,{method:\"get\"}),this.getAnalytics=(e=\"standard\",t=\"\")=>this.doFetch(`${this.getBaseRoute()}/analytics/old${o.buildQueryString({name:e,team_id:t})}`,{method:\"get\"}),this.getRole=e=>this.doFetch(`${this.getRolesRoute()}/${e}`,{method:\"get\"}),this.getRoleByName=e=>this.doFetch(`${this.getRolesRoute()}/name/${e}`,{method:\"get\"}),this.getRolesByNames=e=>this.doFetch(`${this.getRolesRoute()}/names`,{method:\"post\",body:JSON.stringify(e)}),this.patchRole=(e,t)=>this.doFetch(`${this.getRolesRoute()}/${e}/patch`,{method:\"put\",body:JSON.stringify(t)}),this.getSchemes=(e=\"\",t=0,s=d)=>this.doFetch(`${this.getSchemesRoute()}${o.buildQueryString({scope:e,page:t,per_page:s})}`,{method:\"get\"}),this.createScheme=e=>(this.trackEvent(\"api\",\"api_schemes_create\"),this.doFetch(`${this.getSchemesRoute()}`,{method:\"post\",body:JSON.stringify(e)})),this.getScheme=e=>this.doFetch(`${this.getSchemesRoute()}/${e}`,{method:\"get\"}),this.deleteScheme=e=>(this.trackEvent(\"api\",\"api_schemes_delete\"),this.doFetch(`${this.getSchemesRoute()}/${e}`,{method:\"delete\"})),this.patchScheme=(e,t)=>(this.trackEvent(\"api\",\"api_schemes_patch\",{scheme_id:e}),this.doFetch(`${this.getSchemesRoute()}/${e}/patch`,{method:\"put\",body:JSON.stringify(t)})),this.getSchemeTeams=(e,t=0,s=d)=>this.doFetch(`${this.getSchemesRoute()}/${e}/teams${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.getSchemeChannels=(e,t=0,s=d)=>this.doFetch(`${this.getSchemesRoute()}/${e}/channels${o.buildQueryString({page:t,per_page:s})}`,{method:\"get\"}),this.uploadPlugin=(e,t=!1)=>r(this,void 0,void 0,function*(){this.trackEvent(\"api\",\"api_plugin_upload\");let s=new n.default;t&&s.append(\"force\",\"true\"),s.append(\"plugin\",e);let i={method:\"post\",body:s};return s.getBoundary&&(i.headers={\"Content-Type\":`multipart/form-data; boundary=${s.getBoundary()}`}),this.doFetch(this.getPluginsRoute(),i)}),this.installPluginFromUrl=(e,t=!1)=>{this.trackEvent(\"api\",\"api_install_plugin\");let s={plugin_download_url:e,force:t};return this.doFetch(`${this.getPluginsRoute()}/install_from_url${o.buildQueryString(s)}`,{method:\"post\"})},this.getPlugins=()=>this.doFetch(this.getPluginsRoute(),{method:\"get\"}),this.getMarketplacePlugins=(e,t=!1)=>this.doFetch(`${this.getPluginsMarketplaceRoute()}${o.buildQueryString({filter:e||\"\",local_only:t})}`,{method:\"get\"}),this.installMarketplacePlugin=e=>(this.trackEvent(\"api\",\"api_install_marketplace_plugin\"),this.doFetch(`${this.getPluginsMarketplaceRoute()}`,{method:\"post\",body:JSON.stringify({id:e})})),this.getMarketplaceApps=e=>this.doFetch(`${this.getAppsProxyRoute()}/api/v1/marketplace${o.buildQueryString({filter:e||\"\"})}`,{method:\"get\"}),this.getPluginStatuses=()=>this.doFetch(`${this.getPluginsRoute()}/statuses`,{method:\"get\"}),this.removePlugin=e=>this.doFetch(this.getPluginRoute(e),{method:\"delete\"}),this.getWebappPlugins=()=>this.doFetch(`${this.getPluginsRoute()}/webapp`,{method:\"get\"}),this.enablePlugin=e=>this.doFetch(`${this.getPluginRoute(e)}/enable`,{method:\"post\"}),this.disablePlugin=e=>this.doFetch(`${this.getPluginRoute(e)}/disable`,{method:\"post\"}),this.getBoardsUsage=()=>this.doFetch(`/plugins/${h.suitePluginIds.focalboard}/api/v2/limits`,{method:\"get\"}),this.linkGroupSyncable=(e,t,s,i)=>this.doFetch(`${this.getGroupRoute(e)}/${s}s/${t}/link`,{method:\"post\",body:JSON.stringify(i)}),this.unlinkGroupSyncable=(e,t,s)=>this.doFetch(`${this.getGroupRoute(e)}/${s}s/${t}/link`,{method:\"delete\"}),this.getGroupSyncables=(e,t)=>this.doFetch(`${this.getGroupRoute(e)}/${t}s`,{method:\"get\"}),this.getGroup=(e,t=!1)=>this.doFetch(`${this.getGroupRoute(e)}${o.buildQueryString({include_member_count:t})}`,{method:\"get\"}),this.getGroupStats=e=>this.doFetch(`${this.getGroupRoute(e)}/stats`,{method:\"get\"}),this.getGroups=(e=!1,t=0,s=10,i=!1,a=!1)=>{let c={filter_allow_reference:e,page:t,per_page:s,include_member_count:i};return a&&(c.filter_has_member=a),this.doFetch(`${this.getGroupsRoute()}${o.buildQueryString(c)}`,{method:\"get\"})},this.getGroupsByUserId=e=>this.doFetch(`${this.getUsersRoute()}/${e}/groups`,{method:\"get\"}),this.getGroupsNotAssociatedToTeam=(e,t=\"\",s=0,i=d,a=\"ldap\")=>(this.trackEvent(\"api\",\"api_groups_get_not_associated_to_team\",{team_id:e}),this.doFetch(`${this.getGroupsRoute()}${o.buildQueryString({not_associated_to_team:e,page:s,per_page:i,q:t,include_member_count:!0,group_source:a})}`,{method:\"get\"})),this.getGroupsNotAssociatedToChannel=(e,t=\"\",s=0,i=d,a=!1,c=\"ldap\")=>{this.trackEvent(\"api\",\"api_groups_get_not_associated_to_channel\",{channel_id:e});let g={not_associated_to_channel:e,page:s,per_page:i,q:t,include_member_count:!0,filter_parent_team_permitted:a,group_source:c};return this.doFetch(`${this.getGroupsRoute()}${o.buildQueryString(g)}`,{method:\"get\"})},this.createGroupWithUserIds=e=>this.doFetch(this.getGroupsRoute(),{method:\"post\",body:JSON.stringify(e)}),this.addUsersToGroup=(e,t)=>this.doFetch(`${this.getGroupRoute(e)}/members`,{method:\"post\",body:JSON.stringify({user_ids:t})}),this.removeUsersFromGroup=(e,t)=>this.doFetch(`${this.getGroupRoute(e)}/members`,{method:\"delete\",body:JSON.stringify({user_ids:t})}),this.searchGroups=e=>this.doFetch(`${this.getGroupsRoute()}${o.buildQueryString(e)}`,{method:\"get\"}),this.executeAppCall=(e,t)=>r(this,void 0,void 0,function*(){let s=Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{track_as_submit:t,user_agent:\"webapp\"})});return this.doFetch(`${this.getAppsProxyRoute()}/api/v1/call`,{method:\"post\",body:JSON.stringify(s)})}),this.getAppsBindings=(e,t,s)=>r(this,void 0,void 0,function*(){let i={user_id:e,channel_id:t,team_id:s,user_agent:\"webapp\"};return this.doFetch(`${this.getAppsProxyRoute()}/api/v1/bindings${o.buildQueryString(i)}`,{method:\"get\"})}),this.getGroupsAssociatedToTeam=(e,t=\"\",s=0,i=d,a=!1)=>(this.trackEvent(\"api\",\"api_groups_get_associated_to_team\",{team_id:e}),this.doFetch(`${this.getBaseRoute()}/teams/${e}/groups${o.buildQueryString({page:s,per_page:i,q:t,include_member_count:!0,filter_allow_reference:a})}`,{method:\"get\"})),this.getGroupsAssociatedToChannel=(e,t=\"\",s=0,i=d,a=!1)=>(this.trackEvent(\"api\",\"api_groups_get_associated_to_channel\",{channel_id:e}),this.doFetch(`${this.getBaseRoute()}/channels/${e}/groups${o.buildQueryString({page:s,per_page:i,q:t,include_member_count:!0,filter_allow_reference:a})}`,{method:\"get\"})),this.getAllGroupsAssociatedToTeam=(e,t=!1,s=!1)=>this.doFetch(`${this.getBaseRoute()}/teams/${e}/groups${o.buildQueryString({paginate:!1,filter_allow_reference:t,include_member_count:s})}`,{method:\"get\"}),this.getAllGroupsAssociatedToChannelsInTeam=(e,t=!1)=>this.doFetch(`${this.getBaseRoute()}/teams/${e}/groups_by_channels${o.buildQueryString({paginate:!1,filter_allow_reference:t})}`,{method:\"get\"}),this.getAllGroupsAssociatedToChannel=(e,t=!1,s=!1)=>this.doFetch(`${this.getBaseRoute()}/channels/${e}/groups${o.buildQueryString({paginate:!1,filter_allow_reference:t,include_member_count:s})}`,{method:\"get\"}),this.patchGroupSyncable=(e,t,s,i)=>this.doFetch(`${this.getGroupRoute(e)}/${s}s/${t}/patch`,{method:\"put\",body:JSON.stringify(i)}),this.patchGroup=(e,t)=>this.doFetch(`${this.getGroupRoute(e)}/patch`,{method:\"put\",body:JSON.stringify(t)}),this.archiveGroup=e=>this.doFetch(`${this.getGroupRoute(e)}`,{method:\"delete\"}),this.getRedirectLocation=e=>{if(!e.length)return Promise.resolve();let t=`${this.getRedirectLocationRoute()}${o.buildQueryString({url:e})}`;return this.doFetch(t,{method:\"get\"})},this.createBot=e=>this.doFetch(`${this.getBotsRoute()}`,{method:\"post\",body:JSON.stringify(e)}),this.patchBot=(e,t)=>this.doFetch(`${this.getBotRoute(e)}`,{method:\"put\",body:JSON.stringify(t)}),this.getBot=e=>this.doFetch(`${this.getBotRoute(e)}`,{method:\"get\"}),this.getBots=(e=0,t=d)=>this.doFetch(`${this.getBotsRoute()}${o.buildQueryString({page:e,per_page:t})}`,{method:\"get\"}),this.getBotsIncludeDeleted=(e=0,t=d)=>this.doFetch(`${this.getBotsRoute()}${o.buildQueryString({include_deleted:!0,page:e,per_page:t})}`,{method:\"get\"}),this.getBotsOrphaned=(e=0,t=d)=>this.doFetch(`${this.getBotsRoute()}${o.buildQueryString({only_orphaned:!0,page:e,per_page:t})}`,{method:\"get\"}),this.disableBot=e=>this.doFetch(`${this.getBotRoute(e)}/disable`,{method:\"post\"}),this.enableBot=e=>this.doFetch(`${this.getBotRoute(e)}/enable`,{method:\"post\"}),this.assignBot=(e,t)=>this.doFetch(`${this.getBotRoute(e)}/assign/${t}`,{method:\"post\"}),this.getCloudProducts=e=>{let t=\"\";return e&&(t=\"?include_legacy=true\"),this.doFetch(`${this.getCloudRoute()}/products${t}`,{method:\"get\"})},this.getIntegrationsUsage=()=>this.doFetch(`${this.getUsageRoute()}/integrations`,{method:\"get\"}),this.createPaymentMethod=()=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getCloudRoute()}/payment`,{method:\"post\"})}),this.getCloudCustomer=()=>this.doFetch(`${this.getCloudRoute()}/customer`,{method:\"get\"}),this.updateCloudCustomer=e=>this.doFetch(`${this.getCloudRoute()}/customer`,{method:\"put\",body:JSON.stringify(e)}),this.updateCloudCustomerAddress=e=>this.doFetch(`${this.getCloudRoute()}/customer/address`,{method:\"put\",body:JSON.stringify(e)}),this.notifyAdmin=e=>this.doFetchWithResponse(`${this.getUsersRoute()}/notify-admin`,{method:\"post\",body:JSON.stringify(e)}),this.confirmPaymentMethod=e=>r(this,void 0,void 0,function*(){return this.doFetch(`${this.getCloudRoute()}/payment/confirm`,{method:\"post\",body:JSON.stringify({stripe_setup_intent_id:e})})}),this.subscribeCloudProduct=e=>this.doFetch(`${this.getCloudRoute()}/subscription`,{method:\"put\",body:JSON.stringify({product_id:e})}),this.requestCloudTrial=(e,t=\"\")=>this.doFetchWithResponse(`${this.getCloudRoute()}/request-trial`,{method:\"put\",body:JSON.stringify({email:t,subscription_id:e})}),this.validateBusinessEmail=(e=\"\")=>this.doFetchWithResponse(`${this.getCloudRoute()}/validate-business-email`,{method:\"post\",body:JSON.stringify({email:e})}),this.validateWorkspaceBusinessEmail=()=>this.doFetchWithResponse(`${this.getCloudRoute()}/validate-workspace-business-email`,{method:\"post\"}),this.getSubscription=()=>this.doFetch(`${this.getCloudRoute()}/subscription`,{method:\"get\"}),this.getRenewalLink=()=>this.doFetch(`${this.getBaseRoute()}/license/renewal`,{method:\"get\"}),this.getInvoices=()=>this.doFetch(`${this.getCloudRoute()}/subscription/invoices`,{method:\"get\"}),this.getInvoicePdfUrl=e=>`${this.getCloudRoute()}/subscription/invoices/${e}/pdf`,this.getCloudLimits=()=>this.doFetch(`${this.getCloudRoute()}/limits`,{method:\"get\"}),this.getPostsUsage=()=>this.doFetch(`${this.getUsageRoute()}/posts`,{method:\"get\"}),this.getFilesUsage=()=>this.doFetch(`${this.getUsageRoute()}/storage`,{method:\"get\"}),this.getTeamsUsage=()=>this.doFetch(`${this.getUsageRoute()}/teams`,{method:\"get\"}),this.teamMembersMinusGroupMembers=(e,t,s,i)=>{let a=`group_ids=${t.join(\",\")}&page=${s}&per_page=${i}`;return this.doFetch(`${this.getTeamRoute(e)}/members_minus_group_members?${a}`,{method:\"get\"})},this.channelMembersMinusGroupMembers=(e,t,s,i)=>{let a=`group_ids=${t.join(\",\")}&page=${s}&per_page=${i}`;return this.doFetch(`${this.getChannelRoute(e)}/members_minus_group_members?${a}`,{method:\"get\"})},this.getSamlMetadataFromIdp=e=>this.doFetch(`${this.getBaseRoute()}/saml/metadatafromidp`,{method:\"post\",body:JSON.stringify({saml_metadata_url:e})}),this.setSamlIdpCertificateFromMetadata=e=>{let t={method:\"post\",body:e};return t.headers={\"Content-Type\":\"application/x-pem-file\"},this.doFetch(`${this.getBaseRoute()}/saml/certificate/idp`,t)},this.getInProductNotices=(e,t,s)=>this.doFetch(`${this.getNoticesRoute()}/${e}?client=${t}&clientVersion=${s}`,{method:\"get\"}),this.updateNoticesAsViewed=e=>(this.trackEvent(\"ui\",`notice_seen_${e[0]}`),this.doFetch(`${this.getNoticesRoute()}/view`,{method:\"put\",body:JSON.stringify(e)})),this.getAncillaryPermissions=e=>this.doFetch(`${this.getPermissionsRoute()}/ancillary?subsection_permissions=${e.join(\",\")}`,{method:\"get\"}),this.completeSetup=e=>this.doFetch(`${this.getSystemRoute()}/onboarding/complete`,{method:\"post\",body:JSON.stringify(e)}),this.getAppliedSchemaMigrations=()=>this.doFetch(`${this.getSystemRoute()}/schema/version`,{method:\"get\"}),this.fetchWithGraphQL=e=>r(this,void 0,void 0,function*(){return this.doFetch(this.getGraphQLUrl(),{method:\"post\",body:e})}),this.doFetch=(e,t)=>r(this,void 0,void 0,function*(){let{data:s}=yield this.doFetchWithResponse(e,t);return s}),this.doFetchWithResponse=(e,t)=>r(this,void 0,void 0,function*(){let s=yield fetch(e,this.getOptions(t)),i=A(s.headers),a;try{a=yield s.json()}catch{throw new E(this.getUrl(),{message:\"Received invalid response from the server.\",url:e})}if(i.has(h.HEADER_X_VERSION_ID)&&!i.get(\"Cache-Control\")){let g=i.get(h.HEADER_X_VERSION_ID);g&&this.serverVersion!==g&&(this.serverVersion=g)}if(i.has(h.HEADER_X_CLUSTER_ID)){let g=i.get(h.HEADER_X_CLUSTER_ID);g&&this.clusterId!==g&&(this.clusterId=g)}if(s.ok)return{response:s,headers:i,data:a};let c=a.message||\"\";throw this.logToConsole&&console.error(c),new E(this.getUrl(),{message:c,server_error_id:a.id,status_code:a.status_code,url:e})})}getUrl(){return this.url}getAbsoluteUrl(e){return typeof e!=\"string\"||!e.startsWith(\"/\")?e:this.getUrl()+e}getGraphQLUrl(){return`${this.url}${Z}`}setUrl(e){this.url=e}setUserAgent(e){this.userAgent=e}getToken(){return this.token}setToken(e){this.token=e}setCSRF(e){this.csrf=e}setAcceptLanguage(e){this.defaultHeaders[\"Accept-Language\"]=e}setEnableLogging(e){this.enableLogging=e}setIncludeCookies(e){this.includeCookies=e}setUserId(e){this.userId=e}setUserRoles(e){this.userRoles=e}setDiagnosticId(e){this.diagnosticId=e}setTelemetryHandler(e){this.telemetryHandler=e}getServerVersion(){return this.serverVersion}getUrlVersion(){return this.urlVersion}getBaseRoute(){return`${this.url}${this.urlVersion}`}getAppsProxyRoute(){return`${this.url}/plugins/com.mattermost.apps`}getUsersRoute(){return`${this.getBaseRoute()}/users`}getUserRoute(e){return`${this.getUsersRoute()}/${e}`}getTeamsRoute(){return`${this.getBaseRoute()}/teams`}getTeamRoute(e){return`${this.getTeamsRoute()}/${e}`}getTeamSchemeRoute(e){return`${this.getTeamRoute(e)}/scheme`}getTeamNameRoute(e){return`${this.getTeamsRoute()}/name/${e}`}getTeamMembersRoute(e){return`${this.getTeamRoute(e)}/members`}getTeamMemberRoute(e,t){return`${this.getTeamMembersRoute(e)}/${t}`}getChannelsRoute(){return`${this.getBaseRoute()}/channels`}getChannelRoute(e){return`${this.getChannelsRoute()}/${e}`}getChannelMembersRoute(e){return`${this.getChannelRoute(e)}/members`}getChannelMemberRoute(e,t){return`${this.getChannelMembersRoute(e)}/${t}`}getChannelSchemeRoute(e){return`${this.getChannelRoute(e)}/scheme`}getChannelCategoriesRoute(e,t){return`${this.getBaseRoute()}/users/${e}/teams/${t}/channels/categories`}getPostsRoute(){return`${this.getBaseRoute()}/posts`}getPostRoute(e){return`${this.getPostsRoute()}/${e}`}getReactionsRoute(){return`${this.getBaseRoute()}/reactions`}getCommandsRoute(){return`${this.getBaseRoute()}/commands`}getFilesRoute(){return`${this.getBaseRoute()}/files`}getFileRoute(e){return`${this.getFilesRoute()}/${e}`}getPreferencesRoute(e){return`${this.getUserRoute(e)}/preferences`}getIncomingHooksRoute(){return`${this.getBaseRoute()}/hooks/incoming`}getIncomingHookRoute(e){return`${this.getBaseRoute()}/hooks/incoming/${e}`}getOutgoingHooksRoute(){return`${this.getBaseRoute()}/hooks/outgoing`}getOutgoingHookRoute(e){return`${this.getBaseRoute()}/hooks/outgoing/${e}`}getOAuthRoute(){return`${this.url}/oauth`}getOAuthAppsRoute(){return`${this.getBaseRoute()}/oauth/apps`}getOAuthAppRoute(e){return`${this.getOAuthAppsRoute()}/${e}`}getEmojisRoute(){return`${this.getBaseRoute()}/emoji`}getEmojiRoute(e){return`${this.getEmojisRoute()}/${e}`}getBrandRoute(){return`${this.getBaseRoute()}/brand`}getBrandImageUrl(e){return`${this.getBrandRoute()}/image?t=${e}`}getDataRetentionRoute(){return`${this.getBaseRoute()}/data_retention`}getJobsRoute(){return`${this.getBaseRoute()}/jobs`}getPluginsRoute(){return`${this.getBaseRoute()}/plugins`}getPluginRoute(e){return`${this.getPluginsRoute()}/${e}`}getPluginsMarketplaceRoute(){return`${this.getPluginsRoute()}/marketplace`}getRolesRoute(){return`${this.getBaseRoute()}/roles`}getSchemesRoute(){return`${this.getBaseRoute()}/schemes`}getRedirectLocationRoute(){return`${this.getBaseRoute()}/redirect_location`}getBotsRoute(){return`${this.getBaseRoute()}/bots`}getBotRoute(e){return`${this.getBotsRoute()}/${e}`}getGroupsRoute(){return`${this.getBaseRoute()}/groups`}getGroupRoute(e){return`${this.getGroupsRoute()}/${e}`}getNoticesRoute(){return`${this.getBaseRoute()}/system/notices`}getCloudRoute(){return`${this.getBaseRoute()}/cloud`}getUsageRoute(){return`${this.getBaseRoute()}/usage`}getPermissionsRoute(){return`${this.getBaseRoute()}/permissions`}getUserThreadsRoute(e,t){return`${this.getUserRoute(e)}/teams/${t}/threads`}getUserThreadRoute(e,t,s){return`${this.getUserThreadsRoute(e,t)}/${s}`}getSystemRoute(){return`${this.getBaseRoute()}/system`}getCSRFFromCookie(){if(typeof document<\"u\"&&typeof document.cookie<\"u\"){let e=document.cookie.split(\";\");for(let t=0;t<e.length;t++){let s=e[t].trim();if(s.startsWith(\"MMCSRF=\"))return s.replace(\"MMCSRF=\",\"\")}}return\"\"}getOptions(e){let t=Object.assign({},e),s=Object.assign({[R]:\"XMLHttpRequest\"},this.defaultHeaders);this.setAuthHeader&&this.token&&(s[$]=`${p} ${this.token}`);let i=this.csrf||this.getCSRFFromCookie();return e.method&&e.method.toLowerCase()!==\"get\"&&i&&(s[_]=i),this.includeCookies&&(t.credentials=\"include\"),this.userAgent&&(s[O]=this.userAgent),e.body&&(e.body instanceof n.default||(s[l]=\"application/json\")),t.headers&&Object.assign(s,t.headers),Object.assign(Object.assign({},t),{headers:s})}getFileUrl(e,t){let s=`${this.getFileRoute(e)}`;return t&&(s+=`?${t}`),s}getFileThumbnailUrl(e,t){let s=`${this.getFileRoute(e)}/thumbnail`;return t&&(s+=`?${t}`),s}getFilePreviewUrl(e,t){let s=`${this.getFileRoute(e)}/preview`;return t&&(s+=`?${t}`),s}trackEvent(e,t,s){this.telemetryHandler&&this.telemetryHandler.trackEvent(this.userId,this.userRoles,e,t,s)}pageVisited(e,t){this.telemetryHandler&&this.telemetryHandler.pageVisited(this.userId,this.userRoles,e,t)}};h.default=ee;function A(e){let t=new Map,s=new Map;return e.forEach((i,a)=>{let c=a.replace(/\\b[a-z]/g,y=>y.toUpperCase()),g=i;if(i&&i.match(/\\n\\S+:\\s\\S+/)){let y=i.split(`\n`);g=y.shift();let f=new Map(y.map(v=>v.split(/:\\s/)));s=new Map([...s,...f])}t.set(c,g)}),new Map([...t,...s])}h.parseAndMergeNestedHeaders=A;var E=class extends Error{constructor(e,t){super(t.message+\": \"+C.cleanUrlForLogging(e,t.url||\"\")),this.message=t.message,this.url=t.url,this.server_error_id=t.server_error_id,this.status_code=t.status_code,Object.defineProperty(this,\"message\",{enumerable:!0})}};h.ClientError=E}),Le=T(h=>{\"use strict\";Object.defineProperty(h,\"__esModule\",{value:!0});var r=7,u=3e3,m=3e5,n=2e3,b=\"hello\",C=class{constructor(){this.eventCallback=null,this.firstConnectCallback=null,this.reconnectCallback=null,this.missedEventCallback=null,this.errorCallback=null,this.closeCallback=null,this.messageListeners=new Set,this.firstConnectListeners=new Set,this.reconnectListeners=new Set,this.missedMessageListeners=new Set,this.errorListeners=new Set,this.closeListeners=new Set,this.conn=null,this.connectionUrl=null,this.responseSequence=1,this.serverSequence=0,this.connectFailCount=0,this.responseCallbacks={},this.connectionId=\"\"}initialize(o=this.connectionUrl,$){if(!this.conn){if(o==null){console.log(\"websocket must have connection url\");return}this.connectFailCount===0&&console.log(\"websocket connecting to \"+o),this.conn=new WebSocket(`${o}?connection_id=${this.connectionId}&sequence_number=${this.serverSequence}`),this.connectionUrl=o,this.conn.onopen=()=>{var p,l;$&&this.sendMessage(\"authentication_challenge\",{token:$}),this.connectFailCount>0?(console.log(\"websocket re-established connection\"),(p=this.reconnectCallback)===null||p===void 0||p.call(this),this.reconnectListeners.forEach(R=>R())):(this.firstConnectCallback||this.firstConnectListeners.size>0)&&((l=this.firstConnectCallback)===null||l===void 0||l.call(this),this.firstConnectListeners.forEach(R=>R())),this.connectFailCount=0},this.conn.onclose=()=>{var p;this.conn=null,this.responseSequence=1,this.connectFailCount===0&&console.log(\"websocket closed\"),this.connectFailCount++,(p=this.closeCallback)===null||p===void 0||p.call(this,this.connectFailCount),this.closeListeners.forEach(R=>R(this.connectFailCount));let l=u;this.connectFailCount>r&&(l=u*this.connectFailCount*this.connectFailCount,l>m&&(l=m)),l+=Math.random()*n,setTimeout(()=>{this.initialize(o,$)},l)},this.conn.onerror=p=>{var l;this.connectFailCount<=1&&(console.log(\"websocket error\"),console.log(p)),(l=this.errorCallback)===null||l===void 0||l.call(this,p),this.errorListeners.forEach(R=>R(p))},this.conn.onmessage=p=>{var l,R,O;let _=JSON.parse(p.data);if(_.seq_reply)_.error&&console.log(_),this.responseCallbacks[_.seq_reply]&&(this.responseCallbacks[_.seq_reply](_),Reflect.deleteProperty(this.responseCallbacks,_.seq_reply));else if(this.eventCallback||this.messageListeners.size>0){if(_.event===b&&(this.missedEventCallback||this.missedMessageListeners.size>0)&&(console.log(\"got connection id \",_.data.connection_id),this.connectionId!==\"\"&&this.connectionId!==_.data.connection_id&&(console.log(\"long timeout, or server restart, or sequence number is not found.\"),(l=this.missedEventCallback)===null||l===void 0||l.call(this),this.missedMessageListeners.forEach(k=>k()),this.serverSequence=0),this.connectionId=_.data.connection_id),_.seq!==this.serverSequence){console.log(\"missed websocket event, act_seq=\"+_.seq+\" exp_seq=\"+this.serverSequence),this.connectFailCount=0,this.responseSequence=1,(R=this.conn)===null||R===void 0||R.close();return}this.serverSequence=_.seq+1,(O=this.eventCallback)===null||O===void 0||O.call(this,_),this.messageListeners.forEach(k=>k(_))}}}}setEventCallback(o){this.eventCallback=o}addMessageListener(o){this.messageListeners.add(o)}removeMessageListener(o){this.messageListeners.delete(o)}setFirstConnectCallback(o){this.firstConnectCallback=o}addFirstConnectListener(o){this.firstConnectListeners.add(o)}removeFirstConnectListener(o){this.firstConnectListeners.delete(o)}setReconnectCallback(o){this.reconnectCallback=o}addReconnectListener(o){this.reconnectListeners.add(o)}removeReconnectListener(o){this.reconnectListeners.delete(o)}setMissedEventCallback(o){this.missedEventCallback=o}addMissedMessageListener(o){this.missedMessageListeners.add(o)}removeMissedMessageListener(o){this.missedMessageListeners.delete(o)}setErrorCallback(o){this.errorCallback=o}addErrorListener(o){this.errorListeners.add(o)}removeErrorListener(o){this.errorListeners.delete(o)}setCloseCallback(o){this.closeCallback=o}addCloseListener(o){this.closeListeners.add(o)}removeCloseListener(o){this.closeListeners.delete(o)}close(){this.connectFailCount=0,this.responseSequence=1,this.conn&&this.conn.readyState===WebSocket.OPEN&&(this.conn.onclose=()=>{},this.conn.close(),this.conn=null,console.log(\"websocket closed\"))}sendMessage(o,$,p){let l={action:o,seq:this.responseSequence++,data:$};p&&(this.responseCallbacks[l.seq]=p),this.conn&&this.conn.readyState===WebSocket.OPEN?this.conn.send(JSON.stringify(l)):(!this.conn||this.conn.readyState===WebSocket.CLOSED)&&(this.conn=null,this.initialize())}userTyping(o,$,p){let l={channel_id:o,parent_id:$};this.sendMessage(\"user_typing\",l,p)}userUpdateActiveStatus(o,$,p){let l={user_is_active:o,manual:$};this.sendMessage(\"user_update_active_status\",l,p)}getStatuses(o){this.sendMessage(\"get_statuses\",null,o)}getStatusesByIds(o,$){let p={user_ids:o};this.sendMessage(\"get_statuses_by_ids\",p,$)}};h.default=C}),we=T(h=>{\"use strict\";var r=h&&h.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(h,\"__esModule\",{value:!0}),h.WebSocketClient=h.DEFAULT_LIMIT_BEFORE=h.DEFAULT_LIMIT_AFTER=h.ClientError=h.Client4=void 0;var u=Me();Object.defineProperty(h,\"Client4\",{enumerable:!0,get:function(){return r(u).default}}),Object.defineProperty(h,\"ClientError\",{enumerable:!0,get:function(){return u.ClientError}}),Object.defineProperty(h,\"DEFAULT_LIMIT_AFTER\",{enumerable:!0,get:function(){return u.DEFAULT_LIMIT_AFTER}}),Object.defineProperty(h,\"DEFAULT_LIMIT_BEFORE\",{enumerable:!0,get:function(){return u.DEFAULT_LIMIT_BEFORE}});var m=Le();Object.defineProperty(h,\"WebSocketClient\",{enumerable:!0,get:function(){return r(m).default}})}),H=Ae(we()),je=!0,{WebSocketClient:Qe,DEFAULT_LIMIT_BEFORE:De,DEFAULT_LIMIT_AFTER:xe,ClientError:Ge,Client4:We}=H,{default:W,...qe}=H,V=W!==void 0?W:qe});var z={};he(z,{Client4:()=>We,ClientError:()=>Ge,DEFAULT_LIMIT_AFTER:()=>xe,DEFAULT_LIMIT_BEFORE:()=>De,WebSocketClient:()=>Qe,__esModule:()=>je,default:()=>V});var X=U(()=>{B();B()});var He=oe((dt,K)=>{K.exports=(X(),ae(z))});return He();})();\n return mod;})()"
  },
  "functions": {
    "savedPostsProvider": {
      "events": [
        "query:mm-saved"
      ],
      "code": "(() => { var mod=(()=>{var Y=Object.create;var p=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var B=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var w=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(r,t)=>(typeof require!=\"undefined\"?require:r)[t]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var v=(e,r)=>{for(var t in r)p(e,t,{get:r[t],enumerable:!0})},E=(e,r,t,n)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let o of O(r))!j.call(e,o)&&o!==t&&p(e,o,{get:()=>r[o],enumerable:!(n=$(r,o))||n.enumerable});return e};var N=(e,r,t)=>(t=e!=null?Y(B(e)):{},E(r||!e||!e.__esModule?p(t,\"default\",{value:e,enumerable:!0}):t,e)),V=e=>E(p({},\"__esModule\",{value:!0}),e);var ue={};v(ue,{default:()=>le});function P(e){function r(t){let n=String(t);return n.length===1&&(n=\"0\"+n),n}return e.getFullYear()+\"-\"+r(e.getMonth()+1)+\"-\"+r(e.getDate())}function T(e,r){if(r(e))return[e];let t=[];if(e.children)for(let n of e.children)t=[...t,...T(n,r)];return t}function b(e,r){return T(e,t=>t.type===r)[0]}function k(e,r){T(e,r)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var s=self.syscall;var x={};v(x,{parseMarkdown:()=>G});function G(e){return s(\"markdown.parseMarkdown\",e)}var g={};v(g,{deleteAttachment:()=>ne,deletePage:()=>W,getAttachmentMeta:()=>ee,getPageMeta:()=>z,listAttachments:()=>Z,listPages:()=>K,listPlugs:()=>X,readAttachment:()=>te,readPage:()=>H,writeAttachment:()=>re,writePage:()=>J});function K(e=!1){return s(\"space.listPages\",e)}function z(e){return s(\"space.getPageMeta\",e)}function H(e){return s(\"space.readPage\",e)}function J(e,r){return s(\"space.writePage\",e,r)}function W(e){return s(\"space.deletePage\",e)}function X(){return s(\"space.listPlugs\")}function Z(){return s(\"space.listAttachments\")}function ee(e){return s(\"space.getAttachmentMeta\",e)}function te(e){return s(\"space.readAttachment\",e)}function re(e,r,t){return s(\"space.writeAttachment\",e,r,t)}function ne(e){return s(\"space.deleteAttachment\",e)}var S=N(w(\"https://deno.land/std/encoding/yaml.ts\"));async function y(e,r=[\"yaml\"]){let t=await g.readPage(e),n=await x.parseMarkdown(t),o={};return k(n,a=>{if(a.type!==\"FencedCode\")return!1;let c=b(a,\"CodeInfo\");if(!c||!r.includes(c.children[0].text))return!1;let i=b(a,\"CodeText\");if(!i)return!1;let l=i.children[0].text;try{o=S.parse(l)}catch(u){throw console.error(\"YAML Page parser error\",u),new Error(`YAML Error: ${u.message}`)}return!0}),o}async function F(e){try{let t=(await y(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(t===void 0)throw new Error(`No such secret: ${e}`);return t}catch(r){throw r.message===\"Page not found\"?new Error(`No such secret: ${e}`):r}}var ie=N(w(\"https://deno.land/std/encoding/yaml.ts\"));var se=\"SETTINGS\";async function D(e,r){try{let n=(await y(se,[\"yaml\"])||{})[e];return n===void 0?r:n}catch(t){if(t.message===\"Page not found\")return r;throw t}}var A=w(\"https://esm.sh/@mattermost/client@7.4.0\");function M(e,r,t,n=!1){return`${n?e.replace(\"https://\",\"mattermost://\"):e}/${r}/pl/${t}`}async function ae(){let e=await D(\"mattermost\",{}),r=await F(\"mattermost\");return{mattermostServers:e,mattermostSecrets:r}}async function L(e){let{mattermostServers:r,mattermostSecrets:t}=await ae(),n=r[e];if(!n)throw new Error(`No server found for ${e}`);let o=new A.Client4;return o.setUrl(n.url),o.setToken(t[e]),{client:o,config:n}}var h=class{constructor(r){this.client=r;this.channelCache=new Map;this.teamCache=new Map;this.userCache=new Map}async getChannelCached(r){let t=this.channelCache.get(r);return t||(t=await this.client.getChannel(r),this.channelCache.set(r,t),t)}async getTeam(r){let t=this.teamCache.get(r);return t||(t=await this.client.getTeam(r),this.teamCache.set(r,t),t)}async getMyTeams(){let r=await this.client.getMyTeams();for(let t of r)this.teamCache.set(t.id,t);return r}async getAllMyChannels(){let r=await this.getMyTeams();return(await Promise.all(r.map(n=>this.client.getMyChannels(n.id,!1)))).flat()}async getUserCached(r){let t=this.userCache.get(r);return t||(t=await this.client.getUser(r),this.userCache.set(r,t),t)}};function R(e,r){let t=[];if(e.filter.length===0)t=r.slice();else{e:for(let n of r){let o=n;for(let{op:a,prop:c,value:i}of e.filter)switch(a){case\"=\":{let l=o[c];if(Array.isArray(l)&&!Array.isArray(i)){if(!l.includes(i))continue e}else if(Array.isArray(l)&&Array.isArray(i)){if(!l.some(u=>i.includes(u)))continue e}else if(l!=i)continue e;break}case\"!=\":if(o[c]==i)continue e;break;case\"<\":if(!(o[c]<i))continue e;break;case\"<=\":if(!(o[c]<=i))continue e;break;case\">\":if(!(o[c]>i))continue e;break;case\">=\":if(!(o[c]>=i))continue e;break;case\"=~\":if(!new RegExp(i).exec(o[c]))continue e;break;case\"!=~\":if(new RegExp(i).exec(o[c]))continue e;break;case\"in\":if(!i.includes(o[c]))continue e;break}t.push(o)}}return e.orderBy&&(t=t.sort((n,o)=>{let a=e.orderBy,c=e.orderDesc;return n[a]===o[a]?0:n[a]<o[a]?c?1:-1:c?-1:1})),e.limit&&(t=t.slice(0,e.limit)),e.select&&(t=t.map(n=>{let o={};for(let a of e.select)o[a]=n[a];return o})),t}function ce(e){e.create_at&&(e.createdAt=P(new Date(e.create_at))),e.update_at&&(e.updatedAt=P(new Date(e.update_at))),e.edit_at&&(e.editedAt=P(new Date(e.edit_at)))}async function _({query:e}){let r=e.filter.find(f=>f.prop===\"server\");if(!r)throw Error(\"No 'server' filter specified, this is mandatory\");let t=r.value,{client:n,config:o}=await L(t),a=new h(n),c=await n.getMe(),i=await n.getFlaggedPosts(c.id),l=[];for(let f of i.order){let m=i.posts[f];ce(m),l.push(m)}e.limit||(e.limit=15),l=l.slice(0,e.limit);let u=[];return await Promise.all(l.map(async f=>{let m=await a.getChannelCached(f.channel_id),d=o.defaultTeam;m.team_id&&(d=(await a.getTeam(m.team_id)).name),u.push({...f,username:(await a.getUserCached(f.user_id)).username,channelName:m.display_name,teamName:d,server:t,url:M(n.url,d,f.id,!1),desktopUrl:M(n.url,d,f.id,!0)})})),u=R(e,u),u}var le=_;return V(ue);})();\n return mod;})()"
    },
    "unsavePostCommand": {
      "command": {
        "name": "Unsave",
        "contexts": [
          "CommandLink"
        ]
      },
      "code": "(() => { var mod=(()=>{var k=Object.create;var m=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var d=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,n)=>(typeof require!=\"undefined\"?require:t)[n]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var c=(e,t)=>{for(var n in t)m(e,n,{get:t[n],enumerable:!0})},v=(e,t,n,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of F(t))!L.call(e,i)&&i!==n&&m(e,i,{get:()=>t[i],enumerable:!(o=U(t,i))||o.enumerable});return e};var T=(e,t,n)=>(n=e!=null?k(D(e)):{},v(t||!e||!e.__esModule?m(n,\"default\",{value:e,enumerable:!0}):n,e)),R=e=>v(m({},\"__esModule\",{value:!0}),e);var ke={};c(ke,{default:()=>Ne});function p(e,t){if(t(e))return[e];let n=[];if(e.children)for(let o of e.children)n=[...n,...p(o,t)];return n}function P(e,t){return p(e,n=>n.type===t)[0]}function C(e,t){p(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var r=self.syscall;var s={};c(s,{confirm:()=>oe,dispatch:()=>re,enableReadOnlyMode:()=>ie,filterBox:()=>z,flashNotification:()=>K,getCurrentPage:()=>Y,getCursor:()=>B,getSelection:()=>j,getText:()=>O,getVimEnabled:()=>se,hidePanel:()=>J,insertAtCursor:()=>ee,insertAtPos:()=>W,matchBefore:()=>te,moveCursor:()=>Z,navigate:()=>G,openUrl:()=>q,prompt:()=>ne,reloadPage:()=>Q,replaceRange:()=>X,save:()=>I,setPage:()=>$,setSelection:()=>V,setVimEnabled:()=>ae,showPanel:()=>H});function Y(){return r(\"editor.getCurrentPage\")}function $(e){return r(\"editor.setPage\",e)}function O(){return r(\"editor.getText\")}function B(){return r(\"editor.getCursor\")}function j(){return r(\"editor.getSelection\")}function V(e,t){return r(\"editor.setSelection\",e,t)}function I(){return r(\"editor.save\")}function G(e,t,n=!1,o=!1){return r(\"editor.navigate\",e,t,n,o)}function Q(){return r(\"editor.reloadPage\")}function q(e){return r(\"editor.openUrl\",e)}function K(e,t=\"info\"){return r(\"editor.flashNotification\",e,t)}function z(e,t,n=\"\",o=\"\"){return r(\"editor.filterBox\",e,t,n,o)}function H(e,t,n,o=\"\"){return r(\"editor.showPanel\",e,t,n,o)}function J(e){return r(\"editor.hidePanel\",e)}function W(e,t){return r(\"editor.insertAtPos\",e,t)}function X(e,t,n){return r(\"editor.replaceRange\",e,t,n)}function Z(e,t=!1){return r(\"editor.moveCursor\",e,t)}function ee(e){return r(\"editor.insertAtCursor\",e)}function te(e){return r(\"editor.matchBefore\",e)}function re(e){return r(\"editor.dispatch\",e)}function ne(e,t=\"\"){return r(\"editor.prompt\",e,t)}function oe(e){return r(\"editor.confirm\",e)}function ie(e){return r(\"editor.enableReadOnlyMode\",e)}function se(){return r(\"editor.getVimEnabled\")}function ae(e){return r(\"editor.setVimEnabled\",e)}var g={};c(g,{parseMarkdown:()=>le});function le(e){return r(\"markdown.parseMarkdown\",e)}var l={};c(l,{deleteAttachment:()=>ve,deletePage:()=>pe,getAttachmentMeta:()=>ye,getPageMeta:()=>me,listAttachments:()=>xe,listPages:()=>fe,listPlugs:()=>Pe,readAttachment:()=>he,readPage:()=>ge,writeAttachment:()=>we,writePage:()=>de});function fe(e=!1){return r(\"space.listPages\",e)}function me(e){return r(\"space.getPageMeta\",e)}function ge(e){return r(\"space.readPage\",e)}function de(e,t){return r(\"space.writePage\",e,t)}function pe(e){return r(\"space.deletePage\",e)}function Pe(){return r(\"space.listPlugs\")}function xe(){return r(\"space.listAttachments\")}function ye(e){return r(\"space.getAttachmentMeta\",e)}function he(e){return r(\"space.readAttachment\",e)}function we(e,t,n){return r(\"space.writeAttachment\",e,t,n)}function ve(e){return r(\"space.deleteAttachment\",e)}var u={};c(u,{invokeCommand:()=>Ce,invokeFunction:()=>Te,listCommands:()=>be,reloadPlugs:()=>Se});function Te(e,t,...n){return r(\"system.invokeFunction\",e,t,...n)}function Ce(e){return r(\"system.invokeCommand\",e)}function be(){return r(\"system.listCommands\")}function Se(){r(\"system.reloadPlugs\")}var x=T(d(\"https://deno.land/std/encoding/yaml.ts\"));async function y(e,t=[\"yaml\"]){let n=await l.readPage(e),o=await g.parseMarkdown(n),i={};return C(o,a=>{if(a.type!==\"FencedCode\")return!1;let f=P(a,\"CodeInfo\");if(!f||!t.includes(f.children[0].text))return!1;let h=P(a,\"CodeText\");if(!h)return!1;let N=h.children[0].text;try{i=x.parse(N)}catch(w){throw console.error(\"YAML Page parser error\",w),new Error(`YAML Error: ${w.message}`)}return!0}),i}var Me=T(d(\"https://deno.land/std/encoding/yaml.ts\"));var Ee=\"SETTINGS\";async function b(e,t){try{let o=(await y(Ee,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(n){if(n.message===\"Page not found\")return t;throw n}}var S=d(\"https://esm.sh/@mattermost/client@7.4.0\");async function A(e){let t=await b(\"mattermost\",{}),n=e.split(\"/\").slice(0,3).join(\"/\");for(let[o,i]of Object.entries(t))if(i.url===n)return{name:o,config:i};throw new Error(`No server found for ${e}`)}function M(e){let t=/(https?:\\/\\/[^\\/]+)(.*)\\/pl\\/(\\w+)/.exec(e);if(t)return{serverUrl:t[1],postId:t[3]};throw new Error(\"Could not extract post URL from line\")}async function E(){let e=await s.getText(),t=await s.getCursor();for(;t>0&&e[t]!==`\n`;)t--;let n=t+1;for(;n<e.length&&e[n]!==`\n`;)n++;let o=e.substring(t,n);try{console.log(\"Unsaving post\",o);let{serverUrl:i,postId:a}=M(o),{name:f}=await A(i);await s.flashNotification(\"Unsaving post...\"),await u.invokeFunction(\"server\",\"unsavePost\",f,a),await u.invokeCommand(\"Directives: Update\");return}catch(i){console.error(i.message),await s.flashNotification(\"Could not find server for post\",\"error\")}}var Ne=E;return R(ke);})();\n return mod;})()"
    },
    "unsavePost": {
      "env": "server",
      "code": "(() => { var mod=(()=>{var k=Object.create;var a=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var f=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var m=(e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})},v=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of F(t))!L.call(e,i)&&i!==r&&a(e,i,{get:()=>t[i],enumerable:!(o=U(t,i))||o.enumerable});return e};var T=(e,t,r)=>(r=e!=null?k(D(e)):{},v(t||!e||!e.__esModule?a(r,\"default\",{value:e,enumerable:!0}):r,e)),R=e=>v(a({},\"__esModule\",{value:!0}),e);var re={};m(re,{default:()=>te});function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...g(o,t)];return r}function d(e,t){return g(e,r=>r.type===t)[0]}function b(e,t){g(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var c={};m(c,{parseMarkdown:()=>$});function $(e){return n(\"markdown.parseMarkdown\",e)}var s={};m(s,{deleteAttachment:()=>J,deletePage:()=>G,getAttachmentMeta:()=>K,getPageMeta:()=>j,listAttachments:()=>q,listPages:()=>B,listPlugs:()=>Q,readAttachment:()=>z,readPage:()=>V,writeAttachment:()=>H,writePage:()=>I});function B(e=!1){return n(\"space.listPages\",e)}function j(e){return n(\"space.getPageMeta\",e)}function V(e){return n(\"space.readPage\",e)}function I(e,t){return n(\"space.writePage\",e,t)}function G(e){return n(\"space.deletePage\",e)}function Q(){return n(\"space.listPlugs\")}function q(){return n(\"space.listAttachments\")}function K(e){return n(\"space.getAttachmentMeta\",e)}function z(e){return n(\"space.readAttachment\",e)}function H(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function J(e){return n(\"space.deleteAttachment\",e)}var P=T(f(\"https://deno.land/std/encoding/yaml.ts\"));async function l(e,t=[\"yaml\"]){let r=await s.readPage(e),o=await c.parseMarkdown(r),i={};return b(o,u=>{if(u.type!==\"FencedCode\")return!1;let y=d(u,\"CodeInfo\");if(!y||!t.includes(y.children[0].text))return!1;let h=d(u,\"CodeText\");if(!h)return!1;let N=h.children[0].text;try{i=P.parse(N)}catch(w){throw console.error(\"YAML Page parser error\",w),new Error(`YAML Error: ${w.message}`)}return!0}),i}async function S(e){try{let r=(await l(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var X=T(f(\"https://deno.land/std/encoding/yaml.ts\"));var Z=\"SETTINGS\";async function A(e,t){try{let o=(await l(Z,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var x=f(\"https://esm.sh/@mattermost/client@7.4.0\");async function ee(){let e=await A(\"mattermost\",{}),t=await S(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function M(e){let{mattermostServers:t,mattermostSecrets:r}=await ee(),o=t[e];if(!o)throw new Error(`No server found for ${e}`);let i=new x.Client4;return i.setUrl(o.url),i.setToken(r[e]),{client:i,config:o}}async function E(e,t){let{client:r}=await M(e),o=await r.getMe();console.log(\"Unsaving\",o.id,t);let i=await r.deletePreferences(o.id,[{user_id:o.id,category:\"flagged_post\",name:t}]);console.log(\"Done unsaving\",i)}var te=E;return R(re);})();\n return mod;})()"
    },
    "loadPostCommand": {
      "command": {
        "name": "Share: Mattermost Post: Load"
      },
      "code": "(() => { var mod=(()=>{var L=Object.create;var l=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var m=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,n)=>(typeof require!=\"undefined\"?require:t)[n]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var f=(e,t)=>{for(var n in t)l(e,n,{get:t[n],enumerable:!0})},T=(e,t,n,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of Y(t))!I.call(e,i)&&i!==n&&l(e,i,{get:()=>t[i],enumerable:!(o=U(t,i))||o.enumerable});return e};var p=(e,t,n)=>(n=e!=null?L(O(e)):{},T(t||!e||!e.__esModule?l(n,\"default\",{value:e,enumerable:!0}):n,e)),j=e=>T(l({},\"__esModule\",{value:!0}),e);var ke={};f(ke,{default:()=>Ne});var C=p(m(\"https://deno.land/std/encoding/yaml.ts\"));function g(e,t){if(t(e))return[e];let n=[];if(e.children)for(let o of e.children)n=[...n,...g(o,t)];return n}function u(e,t){return g(e,n=>n.type===t)[0]}function h(e,t){g(e,t)}var s={};f(s,{confirm:()=>se,dispatch:()=>oe,enableReadOnlyMode:()=>ae,filterBox:()=>W,flashNotification:()=>J,getCurrentPage:()=>R,getCursor:()=>_,getSelection:()=>V,getText:()=>S,getVimEnabled:()=>ce,hidePanel:()=>Z,insertAtCursor:()=>re,insertAtPos:()=>K,matchBefore:()=>ne,moveCursor:()=>te,navigate:()=>Q,openUrl:()=>z,prompt:()=>ie,reloadPage:()=>H,replaceRange:()=>ee,save:()=>G,setPage:()=>B,setSelection:()=>q,setVimEnabled:()=>le,showPanel:()=>X});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var r=self.syscall;function R(){return r(\"editor.getCurrentPage\")}function B(e){return r(\"editor.setPage\",e)}function S(){return r(\"editor.getText\")}function _(){return r(\"editor.getCursor\")}function V(){return r(\"editor.getSelection\")}function q(e,t){return r(\"editor.setSelection\",e,t)}function G(){return r(\"editor.save\")}function Q(e,t,n=!1,o=!1){return r(\"editor.navigate\",e,t,n,o)}function H(){return r(\"editor.reloadPage\")}function z(e){return r(\"editor.openUrl\",e)}function J(e,t=\"info\"){return r(\"editor.flashNotification\",e,t)}function W(e,t,n=\"\",o=\"\"){return r(\"editor.filterBox\",e,t,n,o)}function X(e,t,n,o=\"\"){return r(\"editor.showPanel\",e,t,n,o)}function Z(e){return r(\"editor.hidePanel\",e)}function K(e,t){return r(\"editor.insertAtPos\",e,t)}function ee(e,t,n){return r(\"editor.replaceRange\",e,t,n)}function te(e,t=!1){return r(\"editor.moveCursor\",e,t)}function re(e){return r(\"editor.insertAtCursor\",e)}function ne(e){return r(\"editor.matchBefore\",e)}function oe(e){return r(\"editor.dispatch\",e)}function ie(e,t=\"\"){return r(\"editor.prompt\",e,t)}function se(e){return r(\"editor.confirm\",e)}function ae(e){return r(\"editor.enableReadOnlyMode\",e)}function ce(){return r(\"editor.getVimEnabled\")}function le(e){return r(\"editor.setVimEnabled\",e)}var c={};f(c,{parseMarkdown:()=>ue});function ue(e){return r(\"markdown.parseMarkdown\",e)}var a={};f(a,{deleteAttachment:()=>Se,deletePage:()=>ye,getAttachmentMeta:()=>ve,getPageMeta:()=>ge,listAttachments:()=>we,listPages:()=>pe,listPlugs:()=>xe,readAttachment:()=>Te,readPage:()=>he,writeAttachment:()=>Ce,writePage:()=>Pe});function pe(e=!1){return r(\"space.listPages\",e)}function ge(e){return r(\"space.getPageMeta\",e)}function he(e){return r(\"space.readPage\",e)}function Pe(e,t){return r(\"space.writePage\",e,t)}function ye(e){return r(\"space.deletePage\",e)}function xe(){return r(\"space.listPlugs\")}function we(){return r(\"space.listAttachments\")}function ve(e){return r(\"space.getAttachmentMeta\",e)}function Te(e){return r(\"space.readAttachment\",e)}function Ce(e,t,n){return r(\"space.writeAttachment\",e,t,n)}function Se(e){return r(\"space.deleteAttachment\",e)}function b(e,t,...n){return r(\"system.invokeFunction\",e,t,...n)}var P=p(m(\"https://deno.land/std/encoding/yaml.ts\"));async function y(e,t=[\"yaml\"]){let n=await a.readPage(e),o=await c.parseMarkdown(n),i={};return h(o,d=>{if(d.type!==\"FencedCode\")return!1;let x=u(d,\"CodeInfo\");if(!x||!t.includes(x.children[0].text))return!1;let w=u(d,\"CodeText\");if(!w)return!1;let F=w.children[0].text;try{i=P.parse(F)}catch(v){throw console.error(\"YAML Page parser error\",v),new Error(`YAML Error: ${v.message}`)}return!0}),i}var Me=p(m(\"https://deno.land/std/encoding/yaml.ts\"));var Ae=\"SETTINGS\";async function A(e,t){try{let o=(await y(Ae,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(n){if(n.message===\"Page not found\")return t;throw n}}var N=m(\"https://esm.sh/@mattermost/client@7.4.0\");async function k(e){let t=await A(\"mattermost\",{}),n=e.split(\"/\").slice(0,3).join(\"/\");for(let[o,i]of Object.entries(t))if(i.url===n)return{name:o,config:i};throw new Error(`No server found for ${e}`)}function $(e){let t=/(https?:\\/\\/[^\\/]+)(.*)\\/pl\\/(\\w+)/.exec(e);if(t)return{serverUrl:t[1],postId:t[3]};throw new Error(\"Could not extract post URL from line\")}async function E(){let e=await s.prompt(\"Mattermost post URL:\");if(!!e)try{let{postId:t,serverUrl:n}=$(e),{name:o}=await k(n),i=await s.prompt(\"Page to store the post:\");if(!i)return;await b(\"server\",\"postToPage\",o,t,i),await s.navigate(i)}catch(t){await s.flashNotification(`Error: ${t.message}`,\"error\");return}}var Ne=E;return j(ke);})();\n return mod;})()"
    },
    "postToPage": {
      "env": "server",
      "code": "(() => { var mod=(()=>{var F=Object.create;var m=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var f=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var d=(e,t)=>{for(var r in t)m(e,r,{get:t[r],enumerable:!0})},C=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of U(t))!O.call(e,i)&&i!==r&&m(e,i,{get:()=>t[i],enumerable:!(o=L(t,i))||o.enumerable});return e};var g=(e,t,r)=>(r=e!=null?F(Y(e)):{},C(t||!e||!e.__esModule?m(r,\"default\",{value:e,enumerable:!0}):r,e)),I=e=>C(m({},\"__esModule\",{value:!0}),e);var oe={};d(oe,{default:()=>ne});var S=g(f(\"https://deno.land/std/encoding/yaml.ts\"));function h(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...h(o,t)];return r}function u(e,t){return h(e,r=>r.type===t)[0]}function P(e,t){h(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var l={};d(l,{parseMarkdown:()=>B});function B(e){return n(\"markdown.parseMarkdown\",e)}var s={};d(s,{deleteAttachment:()=>K,deletePage:()=>H,getAttachmentMeta:()=>W,getPageMeta:()=>q,listAttachments:()=>J,listPages:()=>V,listPlugs:()=>z,readAttachment:()=>X,readPage:()=>G,writeAttachment:()=>Z,writePage:()=>Q});function V(e=!1){return n(\"space.listPages\",e)}function q(e){return n(\"space.getPageMeta\",e)}function G(e){return n(\"space.readPage\",e)}function Q(e,t){return n(\"space.writePage\",e,t)}function H(e){return n(\"space.deletePage\",e)}function z(){return n(\"space.listPlugs\")}function J(){return n(\"space.listAttachments\")}function W(e){return n(\"space.getAttachmentMeta\",e)}function X(e){return n(\"space.readAttachment\",e)}function Z(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function K(e){return n(\"space.deleteAttachment\",e)}var x=g(f(\"https://deno.land/std/encoding/yaml.ts\"));async function p(e,t=[\"yaml\"]){let r=await s.readPage(e),o=await l.parseMarkdown(r),i={};return P(o,c=>{if(c.type!==\"FencedCode\")return!1;let a=u(c,\"CodeInfo\");if(!a||!t.includes(a.children[0].text))return!1;let v=u(c,\"CodeText\");if(!v)return!1;let E=v.children[0].text;try{i=x.parse(E)}catch(T){throw console.error(\"YAML Page parser error\",T),new Error(`YAML Error: ${T.message}`)}return!0}),i}async function M(e){try{let r=(await p(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var te=g(f(\"https://deno.land/std/encoding/yaml.ts\"));var re=\"SETTINGS\";async function A(e,t){try{let o=(await p(re,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var w=f(\"https://esm.sh/@mattermost/client@7.4.0\");async function N(){let e=await A(\"mattermost\",{}),t=await M(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function k(e){let{mattermostServers:t,mattermostSecrets:r}=await N(),o=t[e];if(!o)throw new Error(`No server found for ${e}`);let i=new w.Client4;return i.setUrl(o.url),i.setToken(r[e]),{client:i,config:o}}async function $(e,t,r){let{client:o}=await k(e),i=await o.getPost(t),c=await o.getMe(),a=i.message;c.id===i.user_id&&(a=`---\n$share:\n- 'mm-post:${e}:${t}'\n---\n${a}`),await s.writePage(r,a)}var ne=$;return I(oe);})();\n return mod;})()"
    },
    "publishPostCommand": {
      "command": {
        "name": "Share: Mattermost Post: Publish"
      },
      "code": "(() => { var mod=(()=>{var V=Object.create;var T=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var Q=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var C=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var w=(e,t)=>{for(var r in t)T(e,r,{get:t[r],enumerable:!0})},U=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of G(t))!H.call(e,i)&&i!==r&&T(e,i,{get:()=>t[i],enumerable:!(o=q(t,i))||o.enumerable});return e};var M=(e,t,r)=>(r=e!=null?V(Q(e)):{},U(t||!e||!e.__esModule?T(r,\"default\",{value:e,enumerable:!0}):r,e)),z=e=>U(T({},\"__esModule\",{value:!0}),e);var Be={};w(Be,{default:()=>Re});var u=M(C(\"https://deno.land/std/encoding/yaml.ts\"));function A(e){if(!!e.children)for(let t of e.children){if(t.parent)return;t.parent=e,A(t)}}function N(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...N(o,t)];return r}function k(e,t){if(e.children){let r=e.children.slice();for(let o of r){let i=t(o);if(i!==void 0){let s=e.children.indexOf(o);i?e.children.splice(s,1,i):e.children.splice(s,1)}else k(o,t)}}}function h(e,t){return N(e,r=>r.type===t)[0]}function S(e,t){N(e,t)}function P(e){let t=[];if(e.text!==void 0)return e.text;for(let r of e.children)t.push(P(r));return t.join(\"\")}function Y(e,t=[]){let r={};return A(e),k(e,o=>{if(o.type===\"Hashtag\"){if(o.parent&&o.parent.type===\"Paragraph\"){let a=o.children[0].text.substring(1);r.tags||(r.tags=[]),r.tags.includes(a)||r.tags.push(a)}return}if(o.type===\"FrontMatter\"){let a=o.children[1].children[0],d=P(a);try{let g=u.parse(d),f={...g};if(r={...r,...g},t.length>0){let F=!1;for(let L of t)L in f&&(delete f[L],F=!0);F&&(a.text=u.stringify(f))}if(Object.keys(f).length===0)return null}catch(g){console.error(\"Could not parse frontmatter\",g)}}if(o.type!==\"FencedCode\")return;let i=h(o,\"CodeInfo\");if(!i||i.children[0].text!==\"meta\")return;let s=h(o,\"CodeText\");if(!s)return;let m=s.children[0].text,c=u.parse(m),l={...c};if(r={...r,...c},t.length>0){let a=!1;for(let d of t)d in l&&(delete l[d],a=!0);a&&(s.children[0].text=u.stringify(l).trim())}if(Object.keys(l).length===0)return null}),r.name&&(r.displayName=r.name,delete r.name),r}function O(e,t){let r=null;return S(e,o=>{if(o.type===\"FrontMatter\"){let i=o.children[1].children[0],s=P(i);try{let c={...u.parse(s),...t};r={changes:{from:i.from,to:i.to,insert:u.stringify(c,{noArrayIndent:!0})}}}catch(m){console.error(\"Error parsing YAML\",m)}return!0}return!1}),r||(r={changes:{from:0,to:0,insert:`---\n`+u.stringify(t,{noArrayIndent:!0})+`---\n`}}),r}var p={};w(p,{confirm:()=>ge,dispatch:()=>pe,enableReadOnlyMode:()=>he,filterBox:()=>ie,flashNotification:()=>oe,getCurrentPage:()=>J,getCursor:()=>X,getSelection:()=>Z,getText:()=>$,getVimEnabled:()=>Pe,hidePanel:()=>ae,insertAtCursor:()=>fe,insertAtPos:()=>ce,matchBefore:()=>ue,moveCursor:()=>me,navigate:()=>te,openUrl:()=>ne,prompt:()=>de,reloadPage:()=>re,replaceRange:()=>le,save:()=>ee,setPage:()=>W,setSelection:()=>K,setVimEnabled:()=>ye,showPanel:()=>se});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;function J(){return n(\"editor.getCurrentPage\")}function W(e){return n(\"editor.setPage\",e)}function $(){return n(\"editor.getText\")}function X(){return n(\"editor.getCursor\")}function Z(){return n(\"editor.getSelection\")}function K(e,t){return n(\"editor.setSelection\",e,t)}function ee(){return n(\"editor.save\")}function te(e,t,r=!1,o=!1){return n(\"editor.navigate\",e,t,r,o)}function re(){return n(\"editor.reloadPage\")}function ne(e){return n(\"editor.openUrl\",e)}function oe(e,t=\"info\"){return n(\"editor.flashNotification\",e,t)}function ie(e,t,r=\"\",o=\"\"){return n(\"editor.filterBox\",e,t,r,o)}function se(e,t,r,o=\"\"){return n(\"editor.showPanel\",e,t,r,o)}function ae(e){return n(\"editor.hidePanel\",e)}function ce(e,t){return n(\"editor.insertAtPos\",e,t)}function le(e,t,r){return n(\"editor.replaceRange\",e,t,r)}function me(e,t=!1){return n(\"editor.moveCursor\",e,t)}function fe(e){return n(\"editor.insertAtCursor\",e)}function ue(e){return n(\"editor.matchBefore\",e)}function pe(e){return n(\"editor.dispatch\",e)}function de(e,t=\"\"){return n(\"editor.prompt\",e,t)}function ge(e){return n(\"editor.confirm\",e)}function he(e){return n(\"editor.enableReadOnlyMode\",e)}function Pe(){return n(\"editor.getVimEnabled\")}function ye(e){return n(\"editor.setVimEnabled\",e)}var y={};w(y,{parseMarkdown:()=>ve});function ve(e){return n(\"markdown.parseMarkdown\",e)}var x={};w(x,{deleteAttachment:()=>Le,deletePage:()=>Ae,getAttachmentMeta:()=>$e,getPageMeta:()=>Se,listAttachments:()=>ke,listPages:()=>Ce,listPlugs:()=>Ne,readAttachment:()=>Ee,readPage:()=>be,writeAttachment:()=>Fe,writePage:()=>Me});function Ce(e=!1){return n(\"space.listPages\",e)}function Se(e){return n(\"space.getPageMeta\",e)}function be(e){return n(\"space.readPage\",e)}function Me(e,t){return n(\"space.writePage\",e,t)}function Ae(e){return n(\"space.deletePage\",e)}function Ne(){return n(\"space.listPlugs\")}function ke(){return n(\"space.listAttachments\")}function $e(e){return n(\"space.getAttachmentMeta\",e)}function Ee(e){return n(\"space.readAttachment\",e)}function Fe(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function Le(e){return n(\"space.deleteAttachment\",e)}var v={};w(v,{invokeCommand:()=>Ue,invokeFunction:()=>I,listCommands:()=>Ye,reloadPlugs:()=>Oe});function I(e,t,...r){return n(\"system.invokeFunction\",e,t,...r)}function Ue(e){return n(\"system.invokeCommand\",e)}function Ye(){return n(\"system.listCommands\")}function Oe(){n(\"system.reloadPlugs\")}var E=M(C(\"https://deno.land/std/encoding/yaml.ts\"));async function b(e,t=[\"yaml\"]){let r=await x.readPage(e),o=await y.parseMarkdown(r),i={};return S(o,s=>{if(s.type!==\"FencedCode\")return!1;let m=h(s,\"CodeInfo\");if(!m||!t.includes(m.children[0].text))return!1;let c=h(s,\"CodeText\");if(!c)return!1;let l=c.children[0].text;try{i=E.parse(l)}catch(a){throw console.error(\"YAML Page parser error\",a),new Error(`YAML Error: ${a.message}`)}return!0}),i}async function j(e){try{let r=(await b(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var je=M(C(\"https://deno.land/std/encoding/yaml.ts\"));var De=\"SETTINGS\";async function D(e,t){try{let o=(await b(De,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var R=C(\"https://esm.sh/@mattermost/client@7.4.0\");async function B(){let e=await D(\"mattermost\",{}),t=await j(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function _(){let{mattermostServers:e}=await B(),t=await p.filterBox(\"Select server\",Object.keys(e).map(f=>({name:f})));if(!t)return;let r=t.name,o=await v.invokeFunction(\"server\",\"getAllChannels\",r),i=await p.filterBox(\"Select channel\",o.map(f=>({id:f.id,name:f.display_name})),\"Select the channel to publish to\");if(!i)return;let{id:s}=i,m=await $(),c=await y.parseMarkdown(m),{$share:l}=Y(c,[\"$share\"]);l||(l=[]);let a=P(c),d=await v.invokeFunction(\"server\",\"createPost\",r,s,a),g=O(c,{$share:[...l,`mm-post:${r}:${d.id}`]});await p.dispatch(g)}var Re=_;return z(Be);})();\n return mod;})()"
    },
    "postUnfurlOptions": {
      "events": [
        "unfurl:options"
      ],
      "code": "(() => { var mod=(()=>{var E=Object.create;var c=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var l=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var u=(e,t)=>{for(var r in t)c(e,r,{get:t[r],enumerable:!0})},T=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of L(t))!Y.call(e,i)&&i!==r&&c(e,i,{get:()=>t[i],enumerable:!(o=F(t,i))||o.enumerable});return e};var p=(e,t,r)=>(r=e!=null?E(U(e)):{},T(t||!e||!e.__esModule?c(r,\"default\",{value:e,enumerable:!0}):r,e)),O=e=>T(c({},\"__esModule\",{value:!0}),e);var ne={};u(ne,{default:()=>re});var C=p(l(\"https://deno.land/std/encoding/yaml.ts\"));function d(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...d(o,t)];return r}function m(e,t){return d(e,r=>r.type===t)[0]}function g(e,t){d(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var a={};u(a,{parseMarkdown:()=>R});function R(e){return n(\"markdown.parseMarkdown\",e)}var s={};u(s,{deleteAttachment:()=>Z,deletePage:()=>Q,getAttachmentMeta:()=>J,getPageMeta:()=>V,listAttachments:()=>z,listPages:()=>_,listPlugs:()=>H,readAttachment:()=>W,readPage:()=>q,writeAttachment:()=>X,writePage:()=>G});function _(e=!1){return n(\"space.listPages\",e)}function V(e){return n(\"space.getPageMeta\",e)}function q(e){return n(\"space.readPage\",e)}function G(e,t){return n(\"space.writePage\",e,t)}function Q(e){return n(\"space.deletePage\",e)}function H(){return n(\"space.listPlugs\")}function z(){return n(\"space.listAttachments\")}function J(e){return n(\"space.getAttachmentMeta\",e)}function W(e){return n(\"space.readAttachment\",e)}function X(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function Z(e){return n(\"space.deleteAttachment\",e)}var P=p(l(\"https://deno.land/std/encoding/yaml.ts\"));async function y(e,t=[\"yaml\"]){let r=await s.readPage(e),o=await a.parseMarkdown(r),i={};return g(o,f=>{if(f.type!==\"FencedCode\")return!1;let x=m(f,\"CodeInfo\");if(!x||!t.includes(x.children[0].text))return!1;let w=m(f,\"CodeText\");if(!w)return!1;let $=w.children[0].text;try{i=P.parse($)}catch(v){throw console.error(\"YAML Page parser error\",v),new Error(`YAML Error: ${v.message}`)}return!0}),i}var ee=p(l(\"https://deno.land/std/encoding/yaml.ts\"));var te=\"SETTINGS\";async function b(e,t){try{let o=(await y(te,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var M=l(\"https://esm.sh/@mattermost/client@7.4.0\");async function A(e){let t=await b(\"mattermost\",{}),r=e.split(\"/\").slice(0,3).join(\"/\");for(let[o,i]of Object.entries(t))if(i.url===r)return{name:o,config:i};throw new Error(`No server found for ${e}`)}function N(e){let t=/(https?:\\/\\/[^\\/]+)(.*)\\/pl\\/(\\w+)/.exec(e);if(t)return{serverUrl:t[1],postId:t[3]};throw new Error(\"Could not extract post URL from line\")}async function k(e){try{let{serverUrl:t}=N(e);return await A(t),[{id:\"mattermost-unfurl\",name:\"Mattermost permalink content\"}]}catch{return[]}}var re=k;return O(ne);})();\n return mod;})()"
    },
    "postUnfurl": {
      "events": [
        "unfurl:mattermost-unfurl"
      ],
      "code": "(() => { var mod=(()=>{var U=Object.create;var f=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var u=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var g=(e,t)=>{for(var r in t)f(e,r,{get:t[r],enumerable:!0})},S=(e,t,r,i)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of O(t))!j.call(e,n)&&n!==r&&f(e,n,{get:()=>t[n],enumerable:!(i=Y(t,n))||i.enumerable});return e};var h=(e,t,r)=>(r=e!=null?U(I(e)):{},S(t||!e||!e.__esModule?f(r,\"default\",{value:e,enumerable:!0}):r,e)),D=e=>S(f({},\"__esModule\",{value:!0}),e);var se={};g(se,{default:()=>ie});var b=h(u(\"https://deno.land/std/encoding/yaml.ts\"));function P(e,t){if(t(e))return[e];let r=[];if(e.children)for(let i of e.children)r=[...r,...P(i,t)];return r}function p(e,t){return P(e,r=>r.type===t)[0]}function y(e,t){P(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var c={};g(c,{parseMarkdown:()=>V});function V(e){return o(\"markdown.parseMarkdown\",e)}var a={};g(a,{deleteAttachment:()=>te,deletePage:()=>J,getAttachmentMeta:()=>Z,getPageMeta:()=>Q,listAttachments:()=>X,listPages:()=>G,listPlugs:()=>W,readAttachment:()=>K,readPage:()=>H,writeAttachment:()=>ee,writePage:()=>z});function G(e=!1){return o(\"space.listPages\",e)}function Q(e){return o(\"space.getPageMeta\",e)}function H(e){return o(\"space.readPage\",e)}function z(e,t){return o(\"space.writePage\",e,t)}function J(e){return o(\"space.deletePage\",e)}function W(){return o(\"space.listPlugs\")}function X(){return o(\"space.listAttachments\")}function Z(e){return o(\"space.getAttachmentMeta\",e)}function K(e){return o(\"space.readAttachment\",e)}function ee(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function te(e){return o(\"space.deleteAttachment\",e)}var w=h(u(\"https://deno.land/std/encoding/yaml.ts\"));async function d(e,t=[\"yaml\"]){let r=await a.readPage(e),i=await c.parseMarkdown(r),n={};return y(i,s=>{if(s.type!==\"FencedCode\")return!1;let l=p(s,\"CodeInfo\");if(!l||!t.includes(l.children[0].text))return!1;let m=p(s,\"CodeText\");if(!m)return!1;let L=m.children[0].text;try{n=w.parse(L)}catch(C){throw console.error(\"YAML Page parser error\",C),new Error(`YAML Error: ${C.message}`)}return!0}),n}async function A(e){try{let r=(await d(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var ne=h(u(\"https://deno.land/std/encoding/yaml.ts\"));var oe=\"SETTINGS\";async function v(e,t){try{let i=(await d(oe,[\"yaml\"])||{})[e];return i===void 0?t:i}catch(r){if(r.message===\"Page not found\")return t;throw r}}var T=u(\"https://esm.sh/@mattermost/client@7.4.0\");async function N(e){let t=await v(\"mattermost\",{}),r=e.split(\"/\").slice(0,3).join(\"/\");for(let[i,n]of Object.entries(t))if(n.url===r)return{name:i,config:n};throw new Error(`No server found for ${e}`)}async function k(){let e=await v(\"mattermost\",{}),t=await A(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function $(e){let{mattermostServers:t,mattermostSecrets:r}=await k(),i=t[e];if(!i)throw new Error(`No server found for ${e}`);let n=new T.Client4;return n.setUrl(i.url),n.setToken(r[e]),{client:n,config:i}}function E(e){let t=/(https?:\\/\\/[^\\/]+)(.*)\\/pl\\/(\\w+)/.exec(e);if(t)return{serverUrl:t[1],postId:t[3]};throw new Error(\"Could not extract post URL from line\")}async function F(e){let{serverUrl:t,postId:r}=E(e),{name:i}=await N(t),{client:n}=await $(i),s=await n.getPost(r),l=await n.getUser(s.user_id),m=await n.getChannel(s.channel_id);return`[${l.username}@${m.display_name}](${e}):\n> ${s.message.split(`\n`).join(`\n> `)}`}var ie=F;return D(se);})();\n return mod;})()"
    },
    "checkCredentialsCommand": {
      "command": {
        "name": "Mattermost: Check Credentials"
      },
      "code": "(() => { var mod=(()=>{var L=Object.create;var m=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var f=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,n)=>(typeof require!=\"undefined\"?require:t)[n]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var c=(e,t)=>{for(var n in t)m(e,n,{get:t[n],enumerable:!0})},C=(e,t,n,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of Y(t))!I.call(e,i)&&i!==n&&m(e,i,{get:()=>t[i],enumerable:!(o=U(t,i))||o.enumerable});return e};var h=(e,t,n)=>(n=e!=null?L(O(e)):{},C(t||!e||!e.__esModule?m(n,\"default\",{value:e,enumerable:!0}):n,e)),j=e=>C(m({},\"__esModule\",{value:!0}),e);var Fe={};c(Fe,{default:()=>Ee});var S=h(f(\"https://deno.land/std/encoding/yaml.ts\"));function P(e,t){if(t(e))return[e];let n=[];if(e.children)for(let o of e.children)n=[...n,...P(o,t)];return n}function u(e,t){return P(e,n=>n.type===t)[0]}function y(e,t){P(e,t)}var s={};c(s,{confirm:()=>se,dispatch:()=>oe,enableReadOnlyMode:()=>ae,filterBox:()=>W,flashNotification:()=>J,getCurrentPage:()=>R,getCursor:()=>_,getSelection:()=>V,getText:()=>b,getVimEnabled:()=>ce,hidePanel:()=>Z,insertAtCursor:()=>re,insertAtPos:()=>K,matchBefore:()=>ne,moveCursor:()=>te,navigate:()=>Q,openUrl:()=>z,prompt:()=>ie,reloadPage:()=>H,replaceRange:()=>ee,save:()=>G,setPage:()=>B,setSelection:()=>q,setVimEnabled:()=>le,showPanel:()=>X});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var r=self.syscall;function R(){return r(\"editor.getCurrentPage\")}function B(e){return r(\"editor.setPage\",e)}function b(){return r(\"editor.getText\")}function _(){return r(\"editor.getCursor\")}function V(){return r(\"editor.getSelection\")}function q(e,t){return r(\"editor.setSelection\",e,t)}function G(){return r(\"editor.save\")}function Q(e,t,n=!1,o=!1){return r(\"editor.navigate\",e,t,n,o)}function H(){return r(\"editor.reloadPage\")}function z(e){return r(\"editor.openUrl\",e)}function J(e,t=\"info\"){return r(\"editor.flashNotification\",e,t)}function W(e,t,n=\"\",o=\"\"){return r(\"editor.filterBox\",e,t,n,o)}function X(e,t,n,o=\"\"){return r(\"editor.showPanel\",e,t,n,o)}function Z(e){return r(\"editor.hidePanel\",e)}function K(e,t){return r(\"editor.insertAtPos\",e,t)}function ee(e,t,n){return r(\"editor.replaceRange\",e,t,n)}function te(e,t=!1){return r(\"editor.moveCursor\",e,t)}function re(e){return r(\"editor.insertAtCursor\",e)}function ne(e){return r(\"editor.matchBefore\",e)}function oe(e){return r(\"editor.dispatch\",e)}function ie(e,t=\"\"){return r(\"editor.prompt\",e,t)}function se(e){return r(\"editor.confirm\",e)}function ae(e){return r(\"editor.enableReadOnlyMode\",e)}function ce(){return r(\"editor.getVimEnabled\")}function le(e){return r(\"editor.setVimEnabled\",e)}var l={};c(l,{parseMarkdown:()=>ue});function ue(e){return r(\"markdown.parseMarkdown\",e)}var a={};c(a,{deleteAttachment:()=>Se,deletePage:()=>ye,getAttachmentMeta:()=>ve,getPageMeta:()=>ge,listAttachments:()=>we,listPages:()=>pe,listPlugs:()=>xe,readAttachment:()=>Te,readPage:()=>he,writeAttachment:()=>Ce,writePage:()=>Pe});function pe(e=!1){return r(\"space.listPages\",e)}function ge(e){return r(\"space.getPageMeta\",e)}function he(e){return r(\"space.readPage\",e)}function Pe(e,t){return r(\"space.writePage\",e,t)}function ye(e){return r(\"space.deletePage\",e)}function xe(){return r(\"space.listPlugs\")}function we(){return r(\"space.listAttachments\")}function ve(e){return r(\"space.getAttachmentMeta\",e)}function Te(e){return r(\"space.readAttachment\",e)}function Ce(e,t,n){return r(\"space.writeAttachment\",e,t,n)}function Se(e){return r(\"space.deleteAttachment\",e)}var d={};c(d,{invokeCommand:()=>be,invokeFunction:()=>M,listCommands:()=>Me,reloadPlugs:()=>Ae});function M(e,t,...n){return r(\"system.invokeFunction\",e,t,...n)}function be(e){return r(\"system.invokeCommand\",e)}function Me(){return r(\"system.listCommands\")}function Ae(){r(\"system.reloadPlugs\")}var x=h(f(\"https://deno.land/std/encoding/yaml.ts\"));async function p(e,t=[\"yaml\"]){let n=await a.readPage(e),o=await l.parseMarkdown(n),i={};return y(o,g=>{if(g.type!==\"FencedCode\")return!1;let w=u(g,\"CodeInfo\");if(!w||!t.includes(w.children[0].text))return!1;let v=u(g,\"CodeText\");if(!v)return!1;let F=v.children[0].text;try{i=x.parse(F)}catch(T){throw console.error(\"YAML Page parser error\",T),new Error(`YAML Error: ${T.message}`)}return!0}),i}async function A(e){try{let n=(await p(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(n===void 0)throw new Error(`No such secret: ${e}`);return n}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var ke=h(f(\"https://deno.land/std/encoding/yaml.ts\"));var $e=\"SETTINGS\";async function N(e,t){try{let o=(await p($e,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(n){if(n.message===\"Page not found\")return t;throw n}}var k=f(\"https://esm.sh/@mattermost/client@7.4.0\");async function $(){let e=await N(\"mattermost\",{}),t=await A(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function E(){let{mattermostServers:e}=await $(),t=await s.filterBox(\"Select server\",Object.keys(e).map(n=>({name:n})));if(!!t)try{let n=await d.invokeFunction(\"server\",\"checkCredentials\",t.name);await s.flashNotification(`Authenticated as ${n.username}`)}catch(n){await s.flashNotification(`Failed to authenticate: ${n.message}`,\"error\")}}var Ee=E;return j(Fe);})();\n return mod;})()"
    },
    "checkCredentials": {
      "env": "server",
      "code": "(() => { var mod=(()=>{var F=Object.create;var c=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var l=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var p=(e,t)=>{for(var r in t)c(e,r,{get:t[r],enumerable:!0})},C=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of U(t))!O.call(e,i)&&i!==r&&c(e,i,{get:()=>t[i],enumerable:!(o=L(t,i))||o.enumerable});return e};var d=(e,t,r)=>(r=e!=null?F(Y(e)):{},C(t||!e||!e.__esModule?c(r,\"default\",{value:e,enumerable:!0}):r,e)),I=e=>C(c({},\"__esModule\",{value:!0}),e);var oe={};p(oe,{default:()=>ne});var S=d(l(\"https://deno.land/std/encoding/yaml.ts\"));function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...g(o,t)];return r}function m(e,t){return g(e,r=>r.type===t)[0]}function h(e,t){g(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var a={};p(a,{parseMarkdown:()=>B});function B(e){return n(\"markdown.parseMarkdown\",e)}var s={};p(s,{deleteAttachment:()=>K,deletePage:()=>H,getAttachmentMeta:()=>W,getPageMeta:()=>q,listAttachments:()=>J,listPages:()=>V,listPlugs:()=>z,readAttachment:()=>X,readPage:()=>G,writeAttachment:()=>Z,writePage:()=>Q});function V(e=!1){return n(\"space.listPages\",e)}function q(e){return n(\"space.getPageMeta\",e)}function G(e){return n(\"space.readPage\",e)}function Q(e,t){return n(\"space.writePage\",e,t)}function H(e){return n(\"space.deletePage\",e)}function z(){return n(\"space.listPlugs\")}function J(){return n(\"space.listAttachments\")}function W(e){return n(\"space.getAttachmentMeta\",e)}function X(e){return n(\"space.readAttachment\",e)}function Z(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function K(e){return n(\"space.deleteAttachment\",e)}var y=d(l(\"https://deno.land/std/encoding/yaml.ts\"));async function f(e,t=[\"yaml\"]){let r=await s.readPage(e),o=await a.parseMarkdown(r),i={};return h(o,u=>{if(u.type!==\"FencedCode\")return!1;let w=m(u,\"CodeInfo\");if(!w||!t.includes(w.children[0].text))return!1;let v=m(u,\"CodeText\");if(!v)return!1;let E=v.children[0].text;try{i=y.parse(E)}catch(T){throw console.error(\"YAML Page parser error\",T),new Error(`YAML Error: ${T.message}`)}return!0}),i}async function M(e){try{let r=(await f(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var te=d(l(\"https://deno.land/std/encoding/yaml.ts\"));var re=\"SETTINGS\";async function A(e,t){try{let o=(await f(re,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var x=l(\"https://esm.sh/@mattermost/client@7.4.0\");async function N(){let e=await A(\"mattermost\",{}),t=await M(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function k(e){let{mattermostServers:t,mattermostSecrets:r}=await N(),o=t[e];if(!o)throw new Error(`No server found for ${e}`);let i=new x.Client4;return i.setUrl(o.url),i.setToken(r[e]),{client:i,config:o}}async function $(e){let{client:t}=await k(e);return t.getMe()}var ne=$;return I(oe);})();\n return mod;})()"
    },
    "getAllChannels": {
      "env": "server",
      "code": "(() => { var mod=(()=>{var L=Object.create;var c=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var l=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var d=(e,t)=>{for(var r in t)c(e,r,{get:t[r],enumerable:!0})},S=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of Y(t))!I.call(e,i)&&i!==r&&c(e,i,{get:()=>t[i],enumerable:!(o=U(t,i))||o.enumerable});return e};var g=(e,t,r)=>(r=e!=null?L(O(e)):{},S(t||!e||!e.__esModule?c(r,\"default\",{value:e,enumerable:!0}):r,e)),j=e=>S(c({},\"__esModule\",{value:!0}),e);var ie={};d(ie,{default:()=>oe});var b=g(l(\"https://deno.land/std/encoding/yaml.ts\"));function h(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...h(o,t)];return r}function m(e,t){return h(e,r=>r.type===t)[0]}function P(e,t){h(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var a={};d(a,{parseMarkdown:()=>_});function _(e){return n(\"markdown.parseMarkdown\",e)}var s={};d(s,{deleteAttachment:()=>ee,deletePage:()=>z,getAttachmentMeta:()=>X,getPageMeta:()=>G,listAttachments:()=>W,listPages:()=>q,listPlugs:()=>J,readAttachment:()=>Z,readPage:()=>Q,writeAttachment:()=>K,writePage:()=>H});function q(e=!1){return n(\"space.listPages\",e)}function G(e){return n(\"space.getPageMeta\",e)}function Q(e){return n(\"space.readPage\",e)}function H(e,t){return n(\"space.writePage\",e,t)}function z(e){return n(\"space.deletePage\",e)}function J(){return n(\"space.listPlugs\")}function W(){return n(\"space.listAttachments\")}function X(e){return n(\"space.getAttachmentMeta\",e)}function Z(e){return n(\"space.readAttachment\",e)}function K(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function ee(e){return n(\"space.deleteAttachment\",e)}var f=class{constructor(t){this.client=t;this.channelCache=new Map;this.teamCache=new Map;this.userCache=new Map}async getChannelCached(t){let r=this.channelCache.get(t);return r||(r=await this.client.getChannel(t),this.channelCache.set(t,r),r)}async getTeam(t){let r=this.teamCache.get(t);return r||(r=await this.client.getTeam(t),this.teamCache.set(t,r),r)}async getMyTeams(){let t=await this.client.getMyTeams();for(let r of t)this.teamCache.set(r.id,r);return t}async getAllMyChannels(){let t=await this.getMyTeams();return(await Promise.all(t.map(o=>this.client.getMyChannels(o.id,!1)))).flat()}async getUserCached(t){let r=this.userCache.get(t);return r||(r=await this.client.getUser(t),this.userCache.set(t,r),r)}};var x=g(l(\"https://deno.land/std/encoding/yaml.ts\"));async function u(e,t=[\"yaml\"]){let r=await s.readPage(e),o=await a.parseMarkdown(r),i={};return P(o,p=>{if(p.type!==\"FencedCode\")return!1;let v=m(p,\"CodeInfo\");if(!v||!t.includes(v.children[0].text))return!1;let T=m(p,\"CodeText\");if(!T)return!1;let F=T.children[0].text;try{i=x.parse(F)}catch(C){throw console.error(\"YAML Page parser error\",C),new Error(`YAML Error: ${C.message}`)}return!0}),i}async function A(e){try{let r=(await u(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var re=g(l(\"https://deno.land/std/encoding/yaml.ts\"));var ne=\"SETTINGS\";async function N(e,t){try{let o=(await u(ne,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var w=l(\"https://esm.sh/@mattermost/client@7.4.0\");async function k(){let e=await N(\"mattermost\",{}),t=await A(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function $(e){let{mattermostServers:t,mattermostSecrets:r}=await k(),o=t[e];if(!o)throw new Error(`No server found for ${e}`);let i=new w.Client4;return i.setUrl(o.url),i.setToken(r[e]),{client:i,config:o}}async function E(e){let{client:t}=await $(e);return new f(t).getAllMyChannels()}var oe=E;return j(ie);})();\n return mod;})()"
    },
    "createPost": {
      "env": "server",
      "code": "(() => { var mod=(()=>{var F=Object.create;var c=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var l=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var p=(e,t)=>{for(var r in t)c(e,r,{get:t[r],enumerable:!0})},C=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of U(t))!O.call(e,i)&&i!==r&&c(e,i,{get:()=>t[i],enumerable:!(o=L(t,i))||o.enumerable});return e};var d=(e,t,r)=>(r=e!=null?F(Y(e)):{},C(t||!e||!e.__esModule?c(r,\"default\",{value:e,enumerable:!0}):r,e)),I=e=>C(c({},\"__esModule\",{value:!0}),e);var oe={};p(oe,{default:()=>ne});var S=d(l(\"https://deno.land/std/encoding/yaml.ts\"));function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...g(o,t)];return r}function m(e,t){return g(e,r=>r.type===t)[0]}function h(e,t){g(e,t)}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var a={};p(a,{parseMarkdown:()=>B});function B(e){return n(\"markdown.parseMarkdown\",e)}var s={};p(s,{deleteAttachment:()=>K,deletePage:()=>H,getAttachmentMeta:()=>W,getPageMeta:()=>q,listAttachments:()=>J,listPages:()=>V,listPlugs:()=>z,readAttachment:()=>X,readPage:()=>G,writeAttachment:()=>Z,writePage:()=>Q});function V(e=!1){return n(\"space.listPages\",e)}function q(e){return n(\"space.getPageMeta\",e)}function G(e){return n(\"space.readPage\",e)}function Q(e,t){return n(\"space.writePage\",e,t)}function H(e){return n(\"space.deletePage\",e)}function z(){return n(\"space.listPlugs\")}function J(){return n(\"space.listAttachments\")}function W(e){return n(\"space.getAttachmentMeta\",e)}function X(e){return n(\"space.readAttachment\",e)}function Z(e,t,r){return n(\"space.writeAttachment\",e,t,r)}function K(e){return n(\"space.deleteAttachment\",e)}var y=d(l(\"https://deno.land/std/encoding/yaml.ts\"));async function f(e,t=[\"yaml\"]){let r=await s.readPage(e),o=await a.parseMarkdown(r),i={};return h(o,u=>{if(u.type!==\"FencedCode\")return!1;let w=m(u,\"CodeInfo\");if(!w||!t.includes(w.children[0].text))return!1;let v=m(u,\"CodeText\");if(!v)return!1;let E=v.children[0].text;try{i=y.parse(E)}catch(T){throw console.error(\"YAML Page parser error\",T),new Error(`YAML Error: ${T.message}`)}return!0}),i}async function M(e){try{let r=(await f(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var te=d(l(\"https://deno.land/std/encoding/yaml.ts\"));var re=\"SETTINGS\";async function A(e,t){try{let o=(await f(re,[\"yaml\"])||{})[e];return o===void 0?t:o}catch(r){if(r.message===\"Page not found\")return t;throw r}}var x=l(\"https://esm.sh/@mattermost/client@7.4.0\");async function N(){let e=await A(\"mattermost\",{}),t=await M(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function k(e){let{mattermostServers:t,mattermostSecrets:r}=await N(),o=t[e];if(!o)throw new Error(`No server found for ${e}`);let i=new x.Client4;return i.setUrl(o.url),i.setToken(r[e]),{client:i,config:o}}async function $(e,t,r){let{client:o}=await k(e);return o.createPost({channel_id:t,message:r})}var ne=$;return I(oe);})();\n return mod;})()"
    },
    "updatePost": {
      "env": "server",
      "events": [
        "share:mm-post"
      ],
      "code": "(() => { var mod=(()=>{var B=Object.create;var x=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,G=Object.prototype.hasOwnProperty;var w=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var T=(e,t)=>{for(var r in t)x(e,r,{get:t[r],enumerable:!0})},L=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let o of V(t))!G.call(e,o)&&o!==r&&x(e,o,{get:()=>t[o],enumerable:!(n=_(t,o))||n.enumerable});return e};var C=(e,t,r)=>(r=e!=null?B(q(e)):{},L(t||!e||!e.__esModule?x(r,\"default\",{value:e,enumerable:!0}):r,e)),Q=e=>L(x({},\"__esModule\",{value:!0}),e);var ue={};T(ue,{default:()=>fe});var p=C(w(\"https://deno.land/std/encoding/yaml.ts\"));function S(e){if(!!e.children)for(let t of e.children){if(t.parent)return;t.parent=e,S(t)}}function b(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...b(n,t)];return r}function M(e,t){if(e.children){let r=e.children.slice();for(let n of r){let o=t(n);if(o!==void 0){let s=e.children.indexOf(n);o?e.children.splice(s,1,o):e.children.splice(s,1)}else M(n,t)}}}function u(e,t){return b(e,r=>r.type===t)[0]}function A(e,t){b(e,t)}function g(e){let t=[];if(e.text!==void 0)return e.text;for(let r of e.children)t.push(g(r));return t.join(\"\")}function U(e,t=[]){let r={};return S(e),M(e,n=>{if(n.type===\"Hashtag\"){if(n.parent&&n.parent.type===\"Paragraph\"){let a=n.children[0].text.substring(1);r.tags||(r.tags=[]),r.tags.includes(a)||r.tags.push(a)}return}if(n.type===\"FrontMatter\"){let a=n.children[1].children[0],h=g(a);try{let P=p.parse(h),y={...P};if(r={...r,...P},t.length>0){let E=!1;for(let F of t)F in y&&(delete y[F],E=!0);E&&(a.text=p.stringify(y))}if(Object.keys(y).length===0)return null}catch(P){console.error(\"Could not parse frontmatter\",P)}}if(n.type!==\"FencedCode\")return;let o=u(n,\"CodeInfo\");if(!o||o.children[0].text!==\"meta\")return;let s=u(n,\"CodeText\");if(!s)return;let l=s.children[0].text,m=p.parse(l),c={...m};if(r={...r,...m},t.length>0){let a=!1;for(let h of t)h in c&&(delete c[h],a=!0);a&&(s.children[0].text=p.stringify(c).trim())}if(Object.keys(c).length===0)return null}),r.name&&(r.displayName=r.name,delete r.name),r}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var i=self.syscall;var d={};T(d,{parseMarkdown:()=>J});function J(e){return i(\"markdown.parseMarkdown\",e)}var f={};T(f,{deleteAttachment:()=>ae,deletePage:()=>te,getAttachmentMeta:()=>oe,getPageMeta:()=>Z,listAttachments:()=>ne,listPages:()=>X,listPlugs:()=>re,readAttachment:()=>ie,readPage:()=>K,writeAttachment:()=>se,writePage:()=>ee});function X(e=!1){return i(\"space.listPages\",e)}function Z(e){return i(\"space.getPageMeta\",e)}function K(e){return i(\"space.readPage\",e)}function ee(e,t){return i(\"space.writePage\",e,t)}function te(e){return i(\"space.deletePage\",e)}function re(){return i(\"space.listPlugs\")}function ne(){return i(\"space.listAttachments\")}function oe(e){return i(\"space.getAttachmentMeta\",e)}function ie(e){return i(\"space.readAttachment\",e)}function se(e,t,r){return i(\"space.writeAttachment\",e,t,r)}function ae(e){return i(\"space.deleteAttachment\",e)}var k=C(w(\"https://deno.land/std/encoding/yaml.ts\"));async function v(e,t=[\"yaml\"]){let r=await f.readPage(e),n=await d.parseMarkdown(r),o={};return A(n,s=>{if(s.type!==\"FencedCode\")return!1;let l=u(s,\"CodeInfo\");if(!l||!t.includes(l.children[0].text))return!1;let m=u(s,\"CodeText\");if(!m)return!1;let c=m.children[0].text;try{o=k.parse(c)}catch(a){throw console.error(\"YAML Page parser error\",a),new Error(`YAML Error: ${a.message}`)}return!0}),o}async function O(e){try{let r=(await v(\"SECRETS\",[\"yaml\",\"secrets\"]))[e];if(r===void 0)throw new Error(`No such secret: ${e}`);return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e}`):t}}var le=C(w(\"https://deno.land/std/encoding/yaml.ts\"));var me=\"SETTINGS\";async function I(e,t){try{let n=(await v(me,[\"yaml\"])||{})[e];return n===void 0?t:n}catch(r){if(r.message===\"Page not found\")return t;throw r}}var $=w(\"https://esm.sh/@mattermost/client@7.4.0\");async function j(){let e=await I(\"mattermost\",{}),t=await O(\"mattermost\");return{mattermostServers:e,mattermostSecrets:t}}async function D(e){let{mattermostServers:t,mattermostSecrets:r}=await j(),n=t[e];if(!n)throw new Error(`No server found for ${e}`);let o=new $.Client4;return o.setUrl(n.url),o.setToken(r[e]),{client:o,config:n}}async function R(e){let[t,r,n]=e.uri.split(\":\"),o=await f.readPage(e.name),s=await d.parseMarkdown(o),{$share:l}=U(s,[\"$share\"]);l||(l=[]);let m=g(s),{client:c}=await D(r);return await c.updatePost({id:n,message:m}),!0}var fe=R;return Q(ue);})();\n return mod;})()"
    },
    "boardsQueryProvider": {
      "events": [
        "query:mm-board"
      ],
      "code": "(() => { var mod=(()=>{var P=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var M=(e,t)=>{for(var n in t)P(e,n,{get:t[n],enumerable:!0})},R=(e,t,n,s)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let r of v(t))!A.call(e,r)&&r!==n&&P(e,r,{get:()=>t[r],enumerable:!(s=w(t,r))||s.enumerable});return e};var N=e=>R(P({},\"__esModule\",{value:!0}),e);var O={};M(O,{default:()=>E});function g(e,t){let n=[];if(e.filter.length===0)n=t.slice();else{e:for(let s of t){let r=s;for(let{op:l,prop:i,value:o}of e.filter)switch(l){case\"=\":{let c=r[i];if(Array.isArray(c)&&!Array.isArray(o)){if(!c.includes(o))continue e}else if(Array.isArray(c)&&Array.isArray(o)){if(!c.some(d=>o.includes(d)))continue e}else if(c!=o)continue e;break}case\"!=\":if(r[i]==o)continue e;break;case\"<\":if(!(r[i]<o))continue e;break;case\"<=\":if(!(r[i]<=o))continue e;break;case\">\":if(!(r[i]>o))continue e;break;case\">=\":if(!(r[i]>=o))continue e;break;case\"=~\":if(!new RegExp(o).exec(r[i]))continue e;break;case\"!=~\":if(new RegExp(o).exec(r[i]))continue e;break;case\"in\":if(!o.includes(r[i]))continue e;break}n.push(r)}}return e.orderBy&&(n=n.sort((s,r)=>{let l=e.orderBy,i=e.orderDesc;return s[l]===r[l]?0:s[l]<r[l]?i?1:-1:i?-1:1})),e.limit&&(n=n.slice(0,e.limit)),e.select&&(n=n.map(s=>{let r={};for(let l of e.select)r[l]=s[l];return r})),n}async function B(e){let t=new URL(e),n=t.searchParams.get(\"r\"),s=`${t.protocol}//${t.host}`,[,,,,r,,l]=t.pathname.split(\"/\"),i=`${s}/plugins/focalboard/api/v1/workspaces/${r}/blocks/${l}/subtree?l=3&read_token=${n}`,o=await fetch(i,{headers:{\"x-requested-with\":\"XMLHttpRequest\"}});console.log(\"Got response\",o.status,i),console.log(await o.text())}async function m({query:e}){let t=e.filter.find(s=>s.prop===\"url\");if(!t)throw Error(\"No 'url' filter specified, this is mandatory\");e.filter.splice(e.filter.indexOf(t),1);let n=await B(t.value);return n=g(e,n),n}var E=m;return N(O);})();\n return mod;})()"
    }
  },
  "assets": {}
}